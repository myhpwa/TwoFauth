{"version":3,"sources":["pages/SettingsPage.tsx","components/ShareTextModal.tsx","models/Settings.tsx","redux/reducers/setReducer.tsx","models/TmpSettings.tsx","redux/reducers/index.tsx","redux/reducers/tmpSetReducer.tsx","redux/store.tsx","models/Bookmark.tsx","components/ScanQrCodeModal.tsx","pages/ListPage.tsx","../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","serviceWorkerRegistration.ts","index.tsx","Globals.tsx","App.tsx"],"names":["_SettingsPage","props","reportText","state","showBugReportAlert","showClearAlert","showToast","toastMessage","className","tabIndex","icon","bug","slot","checked","this","hasAppLog","onIonChange","e","isChecked","detail","Globals","enableAppLog","disableAppLog","dispatch","type","key","val","hidden","settings","fill","shape","size","onClick","navigator","userAgent","PackageInfos","pwaVersion","JSON","stringify","getLog","setState","cssClass","backdropDismiss","isOpen","header","subHeader","inputs","name","placeholder","buttons","text","handler","value","a","test","name0","axiosInstance","axios","create","timeout","post","bugReportApiUrl","subject","productName","name1","console","error","role","download","style","flexDirection","textAlign","settingsJsonUri","encodeURIComponent","localStorage","getItem","storeFile","document","createElement","href","click","remove","id","accept","display","onChange","ev","file","target","files","item","fileText","parse","setItem","Error","stack","getElementById","querySelector","onDidPresent","clearAppData","colorPalette","appSettings","theme","interface","interfaceOptions","uiFontSize","min","max","pin","snaps","setImmediate","updateCssVars","helpCircle","onDidDismiss","message","duration","React","Component","SettingsPage","withIonLifeCycle","connect","speechRate","bookmarks","voiceURI","mainVersion","tmpSettings","_ShareTextModal","isAppSettingsExport","Array","Object","keys","length","appSettingsString","filter","i","map","keyVal","join","appUrl","hasQueryString","copyToClipboard","qrcCanvas","qrcode","showModal","swipeToClose","onWillPresent","push","updateQrCode","finish","height","alignItems","flexGrow","flexShrink","margin","width","Settings","version","isInitialized","updateUi","newSettings","body","classList","toggle","TmpSettings","shareTextModal","show","combineReducers","action","forEach","bookmark","bookmarksTemp","idxToDel","findIndex","b","uuid","splice","defaultSettings","undefined","newState","getSavedStore","savedSettingsStr","createStore","reducer","Bookmark","obj","issuer","account","secret","_ScanQrCodeModal","stream","showLoadCameraAlert","uri","exec","decodeURIComponent","loadCamera","videoElement","srcObject","canvas","qr","QrCode","timer","setInterval","getContext","drawImage","decode","toDataURL","callback","result","clearInterval","pause","closeStream","otpauthUriDecode","onloadedmetadata","play","videoWidth","videoHeight","getTracks","t","stop","loadCameraAux","twoPi","Math","PI","_ListPage","tokenUpdateTimer","bookmarkListRef","meter","arc","d3","startAngle","endAngle","innerRadius","outerRadius","showScanQrCodeModal","tokens","reorder","createRef","selectChildren","g","append","attr","currTime","Date","getSeconds","authenticator","generateToken","replace","createProgressCircles","event","complete","rows","index","token","button","preventDefault","replaceAll","color","side","current","closeSlidingItems","swapVertical","ref","disabled","onIonItemReorder","reorderBookmarks","getRows","vertical","horizontal","add","ScanQrCodeModal","uuidv4","ListPage","isLoadingData","webpackAsyncContext","req","__webpack_require__","o","Promise","resolve","then","code","ids","module","exports","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","log","controller","onUpdate","onSuccess","catch","ReactDOM","render","App","URL","process","origin","addEventListener","fetch","headers","response","contentType","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker","serviceWorkCallbacks","pwaUrl","TwoFauthDb","fileName","dbOpenReq","indexedDB","open","ok","fail","onsuccess","db","trans","transaction","objectStore","_ev","data","err","transWrite","reqWrite","put","onerror","delete","clearIndexedDB","clear","geolocation","getCurrentPosition","position","webkit","isWKWebView","messageHandlers","swiftCallbackHandler","isRequestingCamera","cameraResultCode","postMessage","mediaDevices","getUserMedia","video","facingMode","CameraResultCallback","consoleLog","bind","consoleError","isMacCatalyst","isPlatform","platform","from","arguments","apply","fetchErrorContent","fontSize","paddingTop","updateApp","getRegistrations","regs","all","reg","update","newReg","waiting","hasUpdates","reduce","prev","curr","documentElement","cssText","isTouchDevice","isStoreApps","getFileFromIndexedDB","saveFileToIndexedDB","removeFileFromIndexedDB","removeElementsByClassName","doc","elements","getElementsByClassName","parentNode","removeChild","disableAndroidChromeCallout","stopPropagation","disableIosSafariCallout","s","getSelection","rangeCount","r","getRangeAt","removeAllRanges","setTimeout","addRange","clipboard","writeText","electronBackendApi","store","setupConfig","mode","swipeBackEnabled","_App","AppOrig","_AppOrig","registrationNew","originalAppSettingsStr","wakeLock","receive","send","oncontextmenu","ontouchend","queryParams","queryString","search","split","setting","showUpdateAlert","showRestoreAppSettingsToast","speechSynthesis","getVoices","cancel","wakeLockScreen","visibilityState","wakeLockScreenRelease","onupgradeneeded","createObjectStore","request","release","routeMatches","queryMatches","route","query","to","pathname","animated","path","exact","routeByQueryString","tab","restoreAppSettings","withRouter"],"mappings":"8mHAoCMA,E,kDACJ,WAAYC,GAAa,IAAD,8BACtB,cAAMA,IAaRC,WAAa,GAXX,EAAKC,MAAQ,CACXC,oBAAoB,EACpBC,gBAAgB,EAChBC,WAAW,EACXC,aAAc,IAPM,E,oDAWxB,c,oBAIA,WAAU,IAAD,OACP,OACE,eAAC,IAAD,WACE,cAAC,IAAD,UACE,cAAC,IAAD,UACE,cAAC,IAAD,CAAUC,UAAU,SAApB,8BAGJ,eAAC,IAAD,WACE,eAAC,IAAD,WACE,eAAC,IAAD,WACE,qBAAKC,SAAU,IACf,cAAC,IAAD,CAASC,KAAMC,IAAKC,KAAK,UACzB,cAAC,IAAD,CAAUJ,UAAU,uBAApB,uDACA,cAAC,IAAD,CAAWI,KAAK,MAAMC,QAASC,KAAKb,MAAMc,UAAWC,YAAa,SAAAC,GAChE,IAAMC,EAAYD,EAAEE,OAAON,QAEvB,EAAKZ,MAAMc,YAAcG,IAI7BA,EAAYE,IAAQC,eAAiBD,IAAQE,gBAC7C,EAAKrB,MAAMsB,SAAS,CAClBC,KAAM,cACNC,IAAK,YACLC,IAAKR,WAIX,eAAC,IAAD,CAASS,QAASb,KAAKb,MAAM2B,SAASb,UAAtC,UACE,qBAAKN,SAAU,IACf,cAAC,IAAD,CAASC,KAAMC,IAAKC,KAAK,UACzB,cAAC,IAAD,CAAUJ,UAAU,uBAApB,uDACA,cAAC,IAAD,CAAWqB,KAAK,UAAUC,MAAM,QAAQlB,KAAK,MAAMmB,KAAK,QAAQvB,UAAU,SAASwB,QAAS,SAAAf,GAC1F,EAAKf,WAAa,2BAAS+B,UAAUC,UAAY,4BAAeC,EAAaC,WAAa,4BAAeC,KAAKC,UAAU,EAAKrC,MAAM2B,UAAY,kBAAeR,IAAQmB,SACtK,EAAKC,SAAS,CAAEpC,oBAAoB,KAFtC,0BAIA,cAAC,IAAD,CACEqC,SAAS,SACTC,iBAAiB,EACjBC,OAAQ7B,KAAKX,MAAMC,mBACnBwC,OAAQ,2BACRC,UAAU,sEACVC,OAAQ,CACN,CACEC,KAAM,QACNvB,KAAM,QACNwB,YAAa,+BAEf,CACED,KAAM,QACNvB,KAAM,WACNwB,YAAa,+CAGjBC,QAAS,CACP,CACEC,KAAM,eACNT,SAAU,iBACVU,QAAQ,WAAD,4BAAE,WAAOC,GAAP,eAAAC,EAAA,yDACF,iDAAiDC,KAAKF,EAAMG,OAD1D,uBAEL,EAAKf,SAAS,CAAEpC,oBAAoB,EAAOE,WAAW,EAAMC,aAAa,4DAFpE,0CAOCiD,EAAgBC,IAAMC,OAAO,CAAEC,QAAS,MAPzC,SAQCH,EAAcI,KAAKxC,IAAQyC,gBAAiB,CAChDC,QAAQ,GAAD,OAAK3B,EAAa4B,YAAlB,wCACPb,KAAK,WAAD,OAAaE,EAAMG,MAAnB,yCAAqCH,EAAMY,MAA3C,eAAuD,EAAK9D,cAV7D,OAYL,EAAKsC,SAAS,CAAEpC,oBAAoB,EAAOE,WAAW,EAAMC,aAAa,yCAZpE,kDAcL0D,QAAQC,MAAR,MACA,EAAK1B,SAAS,CAAEpC,oBAAoB,EAAOE,WAAW,EAAMC,aAAa,yCAfpE,0DAAF,mDAAC,IAmBV,CACE2C,KAAM,eACNiB,KAAM,SACN1B,SAAU,mBACVU,QAAS,kBAAM,EAAKX,SAAS,CAAEpC,oBAAoB,YAK3D,eAAC,IAAD,WACE,qBAAKK,SAAU,IACf,cAAC,IAAD,CAASC,KAAM0D,IAAUxD,KAAK,UAC9B,qBAAKJ,UAAU,eAAf,SACE,sBAAK6D,MAAO,CAAEC,cAAe,UAA7B,UACE,cAAC,IAAD,CAAU9D,UAAU,uBAApB,8BACA,sBAAK6D,MAAO,CAAEE,UAAW,SAAzB,UACE,cAAC,IAAD,CAAW1C,KAAK,UAAUC,MAAM,QAAQC,KAAK,QAAQvB,UAAU,SAASwB,QAAO,uCAAE,WAAOf,GAAP,MAAAoC,EAAA,SAAAA,EAAA,sDACzEmB,EADyE,uCACvBC,mBAAmBC,aAAaC,QAAQvD,IAAQwD,YAAc,MAChHvB,EAAIwB,SAASC,cAAc,MAC/BC,KAAOP,EACTnB,EAAEe,SAAWhD,IAAQwD,UACrBvB,EAAE2B,QACF3B,EAAE4B,SAN6E,2CAAF,sDAA/E,0BAQA,uBAAOC,GAAG,kBAAkB1D,KAAK,OAAO2D,OAAO,QAAQd,MAAO,CAAEe,QAAS,QAAUC,SAAQ,uCAAE,WAAOC,GAAP,mBAAAjC,EAAA,6DACrFkC,EADqF,UAC9ED,EAAGE,OAAOC,aADoE,aAC9E,EAAiBC,KAAK,GADwD,gBAEpEH,QAFoE,IAEpEA,OAFoE,EAEpEA,EAAMrC,OAF8D,gDAEpD,GAFoD,OAErFyC,EAFqF,KAG3F,IAEEtD,KAAKuD,MAAMD,GACXjB,aAAamB,QAAQzE,IAAQwD,UAAWe,GACxC,EAAK1F,MAAMsB,SAAS,CAAEC,KAAM,kBAC5B,MAAOP,GACPgD,QAAQC,MAAMjD,GACdgD,QAAQC,OAAM,IAAI4B,OAAQC,OAE3BlB,SAASmB,eAAe,mBAAwC5C,MAAQ,GAZkB,2CAAF,wDAe3F,cAAC,IAAD,CAAWvB,KAAK,UAAUC,MAAM,QAAQC,KAAK,QAAQvB,UAAU,SAASwB,QAAS,SAACf,GAC/E4D,SAASoB,cAAc,oBAAyCjB,SADnE,0BAGA,cAAC,IAAD,CAAWnD,KAAK,UAAUC,MAAM,QAAQC,KAAK,QAAQvB,UAAU,SAASwB,QAAS,SAACf,GAChF,EAAKuB,SAAS,CAAEnC,gBAAgB,KADlC,0BAGA,cAAC,IAAD,CACEoC,SAAS,SACTE,OAAQ7B,KAAKX,MAAME,eACnBqC,iBAAiB,EACjBwD,aAAc,SAACZ,KAEf1C,OAAQ,wKACRK,QAAS,CACP,CACEC,KAAM,eACNT,SAAU,iBACVU,QAAS,SAACC,GACR,EAAKZ,SAAS,CACZnC,gBAAgB,MAItB,CACE6C,KAAM,eACNT,SAAU,mBACVU,QAAQ,WAAD,4BAAE,WAAOC,GAAP,SAAAC,EAAA,sEACDjC,IAAQ+E,eADP,OAEP,EAAKlG,MAAMsB,SAAS,CAAEC,KAAM,qBAC5B,EAAKgB,SAAS,CAAEnC,gBAAgB,EAAOC,WAAW,EAAMC,aAAc,8BAH/D,2CAAF,mDAAC,kBAYtB,eAAC,IAAD,WACE,qBAAKE,SAAU,IACf,cAAC,IAAD,CAASC,KAAM0F,IAAcxF,KAAK,UAClC,cAAC,IAAD,CAAUJ,UAAU,uBAApB,SAA4CY,IAAQiF,YAAR,QAC5C,eAAC,IAAD,CAAWzF,KAAK,MACdwC,OAAQtC,KAAKb,MAAMqG,MACnB9F,UAAU,SACV+F,UAAU,UACVC,iBAAkB,CAAE/D,SAAU,kBAC9BzB,YAAa,SAAAC,GACX,IAAMmC,GAASnC,EAAEE,OAAOiC,OAKnB,EAAKnD,MAAMqG,QAAUlD,GAI1B,EAAKnD,MAAMsB,SAAS,CAClBC,KAAM,cACNC,IAAK,QACLC,IAAK0B,KAlBX,UAqBE,cAAC,IAAD,CAAiB5C,UAAU,eAAe4C,MAAO,EAAjD,0BACA,cAAC,IAAD,CAAiB5C,UAAU,cAAc4C,MAAO,EAAhD,0BACA,cAAC,IAAD,CAAiB5C,UAAU,eAAe4C,MAAO,EAAjD,0BACA,cAAC,IAAD,CAAiB5C,UAAU,kBAAkB4C,MAAO,EAApD,0BACA,cAAC,IAAD,CAAiB5C,UAAU,gBAAgB4C,MAAO,EAAlD,sCAGJ,eAAC,IAAD,WACE,qBAAK3C,SAAU,IACf,cAAC,IAAD,CAASC,KAAMwC,IAAMtC,KAAK,UAC1B,qBAAKJ,UAAU,eAAf,SACE,sBAAK6D,MAAO,CAAEC,cAAe,UAA7B,UACE,eAAC,IAAD,CAAU9D,UAAU,uBAApB,UAA4CY,IAAQiF,YAAR,WAA5C,KAAiFvF,KAAKb,MAAMwG,cAC5F,cAAC,IAAD,CAAUC,IAAK,GAAIC,IAAK,GAAIC,KAAK,EAAMC,OAAO,EAAMzD,MAAOtC,KAAKb,MAAMwG,WAAYzF,YAAa,SAAAC,GAC7F,EAAKhB,MAAMsB,SAAS,CAClBC,KAAM,cACNC,IAAK,aACLC,KAAMT,EAAEE,OAAOiC,QAEjB0D,GAAa,WACX1F,IAAQ2F,cAAc,EAAK9G,MAAM2B,wBAM3C,eAAC,IAAD,WACE,qBAAKnB,SAAU,IACf,cAAC,IAAD,CAASC,KAAMsG,IAAYpG,KAAK,UAChC,sBAAKJ,UAAU,SAAf,UACE,+CACA,gEACA,8BAAK,mBAAGuE,KAAK,sBAAsBS,OAAO,OAArC,qCAKX,cAAC,IAAD,CACE/C,SAAS,SACTE,OAAQ7B,KAAKX,MAAMG,UACnB2G,aAAc,kBAAM,EAAKzE,SAAS,CAAElC,WAAW,KAC/C4G,QAASpG,KAAKX,MAAMI,aACpB4G,SAAU,gB,GA9OMC,IAAMC,WAmQ5BC,EAAeC,YAAiBvH,GAEvBwH,iBAfS,SAACrH,GACvB,MAAO,CACLyB,SAAUzB,EAAMyB,SAChBb,UAAWZ,EAAMyB,SAASb,UAC1BuF,MAAOnG,EAAMyB,SAAS0E,MACtBG,WAAYtG,EAAMyB,SAAS6E,WAC3BgB,WAAYtH,EAAMyB,SAAS6F,WAC3BC,UAAWvH,EAAMyB,SAAS8F,UAC1BC,SAAUxH,EAAMyB,SAAS+F,SACzBC,YAAazH,EAAM0H,YAAYD,eAMpBJ,CAEbF,K,yJCpRIQ,E,kDAEJ,WAAY7H,GAAa,IAAD,8BACtB,cAAMA,IACDE,MAAQ,CACX4H,oBAAqBC,MAAeC,OAAOC,KAAK9G,IAAQiF,aAAa8B,SAHjD,E,gDAOxB,WAAgB,IAAD,OAETC,EADsBH,OAAOC,KAAK9G,IAAQiF,aAAagC,QAAO,SAAC5G,EAAK6G,GAAN,OAAY,EAAKnI,MAAM4H,oBAAoBO,MAAIC,KAAI,SAAC9G,EAAK6G,GAAO,MAAO,CAAC7G,IAAKA,EAAKC,IAAK,EAAKzB,MAAM2B,SAASH,OACpH8G,KAAI,SAAAC,GAAM,gBAAOA,EAAO/G,IAAd,aAAsB+G,EAAO9G,QAAO+G,KAAK,KAC5GL,EAA0C,KAAtBA,EAAA,mBAAuCA,GAAsB,KACjF,IAAIM,EAAS5H,KAAKb,MAAMiD,KAClByF,EAAiB,KAAKrF,KAAKoF,GAC7BN,IACFM,GAAUC,EAAc,WAAOP,GAAP,WAAiCA,IAG3DhH,IAAQwH,gBAAgBF,GACxB,IAAMG,EAAYhE,SAASmB,eAAe,aAE1C,OADA8C,WAAgBD,EAAWH,GACpBG,I,oBAGT,WAAU,IAAD,OACP,OACE,cAAC,IAAD,CACElG,OAAQ7B,KAAKb,MAAM8I,UACnBtG,SAAS,SACTuG,cAAc,EAEdC,cAAe,WAEb,IADA,IAAIlB,EAAsC,GACjCO,EAAI,EAAGA,EAAI,EAAKnI,MAAM4H,oBAAoBI,OAAQG,IACzDP,EAAoBmB,MAAK,GAE3B,EAAK1G,SAAS,CAACuF,oBAAqBA,IACpC,EAAKoB,gBAEPlC,aAAc,kBAAM,EAAKhH,MAAMmJ,UAbjC,SAcE,cAAC,IAAD,UACE,sBAAK/E,MAAO,CAAEe,QAAS,OAAQd,cAAe,SAAU+E,OAAQ,OAAQC,WAAY,UAApF,UACE,8BACE,cAAC,IAAD,CAAU9I,UAAU,SAApB,2FAEF,8BACE,cAAC,IAAD,CAAUA,UAAU,SAApB,kEAEF,qBAAK6D,MAAO,CAAEkF,SAAU,EAAGC,WAAY,EAAGpE,QAAS,OAAQkE,WAAY,SAAUG,OAAQ,IAAzF,SACE,wBAAQvE,GAAG,YAAYwE,MAAM,MAAML,OAAO,MAAMhF,MAAO,CAAEoF,OAAQ,gBAEnE,gCACE,cAAC,IAAD,CAAUjJ,UAAU,SAApB,0CACA,cAAC,IAAD,UAEIyH,OAAOC,KAAK9G,IAAQiF,aAAakC,KAAI,SAAC9G,EAAK6G,GAAN,OACnC,eAAC,IAAD,WACE,cAAC,IAAD,CAAU9H,UAAU,uBAApB,SAA4CY,IAAQiF,YAAY5E,KAChE,cAAC,IAAD,CAAWb,KAAK,MAAMI,YAAa,SAAAC,GACjC,IAAM8G,EAAuB,EAAK5H,MAAM4H,oBACxCA,EAAoBO,GAAKrH,EAAEE,OAAON,QAClC,EAAK2B,SAAS,CAACuF,oBAAqBA,IACpC,EAAKoB,oBANT,+BAAsCb,YAa9C,8BACE,cAAC,IAAD,CAAWzG,KAAK,UAAUC,MAAM,QAAQC,KAAK,QAAQC,QAAS,kBAAM,EAAK/B,MAAMmJ,UAA/E,uC,GAvEgBhC,IAAMC,WAwFrBG,iBARS,SAACrH,GACvB,MAAO,CACLyB,SAAUzB,EAAMyB,YAML4F,CAEbM,I,6GC/GW6B,EAAb,sCACIC,QAAkB,EADtB,KAEI7I,WAAqB,EAFzB,KAGIuF,MAAgB,EAHpB,KAIIG,WAAqB,GAJzB,KAKIoD,eAAyB,EAL7B,KAMInC,UAAwB,ICL5B,SAASoC,EAASC,GAChB,KAAOlF,SAASmF,KAAKC,UAAU9B,OAAS,GACtCtD,SAASmF,KAAKC,UAAUhF,OAAOJ,SAASmF,KAAKC,UAAUvE,KAAK,IAE9Db,SAASmF,KAAKC,UAAUC,OAAxB,eAAuCH,EAAYzD,QAAS,GAC5DlF,IAAQ2F,cAAcgD,GCRjB,IAAMI,EAAb,sCACIC,eAAiB,CAAElH,KAAM,GAAImH,MAAM,ICIxBC,kBAAgB,CAC7B1I,SFMa,WAAuD,IAAtCzB,EAAqC,uDAA7B,IAAIwJ,EAAYY,EAAa,uCAC/DR,EAAW,eAAQ5J,GACvB,OAAQoK,EAAO/I,MACb,IAAK,gBAEHsI,EADAC,EAAc1H,KAAKuD,MAAMlB,aAAaC,QAAQvD,IAAQwD,YAAahD,UAEnE,MACF,IAAK,cACH,IAAIH,EAAM8I,EAAO9I,IACbC,EAAM6I,EAAO7I,IACjB,OAAQD,GACN,IAAK,QACHoD,SAASmF,KAAKC,UAAUO,SAAQ,SAAC9I,GAC3B,QAAQ4B,KAAK5B,IACfmD,SAASmF,KAAKC,UAAUhF,OAAOvD,MAGnCmD,SAASmF,KAAKC,UAAUC,OAAxB,eAAuCxI,IAAO,GAKjDqI,EAAoBtI,GAAOC,EAC5BgD,aAAamB,QAAQzE,IAAQwD,UAAWvC,KAAKC,UAAU,CAAEV,SAAUmI,KACnE,MACF,IAAK,eACHA,EAAYrC,UAAZ,sBAA4BqC,EAAYrC,WAAxC,CAAmD6C,EAAOE,WAC1D/F,aAAamB,QAAQzE,IAAQwD,UAAWvC,KAAKC,UAAU,CAAEV,SAAUmI,KACnE,MACF,IAAK,eACH,IAAIW,EAAgBX,EAAYrC,UAC1BiD,EAAWD,EAAcE,WAAU,SAACC,GAAQ,OAAOA,EAAEC,OAASP,EAAOO,SACzD,IAAdH,GACFD,EAAcK,OAAOJ,EAAU,GAEjCZ,EAAYrC,UAAZ,YAA4BgD,GAC5BhG,aAAamB,QAAQzE,IAAQwD,UAAWvC,KAAKC,UAAU,CAAEV,SAAUmI,KACnE,MAEF,IAAK,mBACHA,EAAYrC,UAAY6C,EAAO7C,UAC/BhD,aAAamB,QAAQzE,IAAQwD,UAAWvC,KAAKC,UAAU,CAAEV,SAAUmI,KACnE,MAGF,IAAK,mBAEHD,EADAC,EAAc,IAAIJ,GAElB,MAEF,QAC0C,IAApC1B,OAAOC,KAAK6B,GAAa5B,SAC3B4B,EAAc,IAAIJ,GAEpB,IAAMqB,EAAkB,IAAIrB,EAC5B1B,OAAOC,KAAK8C,GAAiBR,SAAQ,SAAA/I,QACDwJ,IAA7BlB,EAAoBtI,KACtBsI,EAAoBtI,GAAQuJ,EAAwBvJ,OAI7D,OAAOsI,GEnEGlC,YCHG,WAA0D,IAAzC1H,EAAwC,uDAAhC,IAAIgK,EAAeI,EAAa,uCAClEW,EAAQ,eAAQ/K,GAChBsB,EAAM8I,EAAO9I,IACbC,EAAM6I,EAAO7I,IAEjB,OADCwJ,EAAiBzJ,GAAOC,EACjB6I,EAAO/I,MACb,IAAK,kBACH,OAAO0J,EAKX,OAAO/K,KCFM,SAASgL,IACpB,IAAIC,EAAmB1G,aAAaC,QAAQvD,IAAQwD,WAQpD,OAPwB,MAApBwG,EACaC,YAAYC,EAASjJ,KAAKuD,MAAMwF,IAGhCC,YAAYC,K,qKCnBpBC,G,OAMT,WAAYC,GAAgB,yBAL5BV,KAAe,GAKY,KAJ3BW,OAAiB,GAIU,KAH3BC,QAAkB,GAGS,KAF3BC,OAAiB,GAGb7K,KAAKgK,KAAOU,EAAIV,KAChBhK,KAAK2K,OAASD,EAAIC,OAClB3K,KAAK4K,QAAUF,EAAIE,QACnB5K,KAAK6K,OAASH,EAAIG,S,uCCapBC,E,kDAEJ,WAAY3L,GAAa,IAAD,8BACtB,cAAMA,IAiBR4L,YAlBwB,EAEtB,EAAK1L,MAAQ,CACX2L,qBAAqB,GAHD,E,oDAOxB,SAAiBC,GAEf,IACA,EADY,sCACkBC,KAAKD,GAAnC,mBAAON,EAAP,KAAeC,EAAf,KACAD,EAASQ,mBAAmBR,GAC5BC,EAAUO,mBAAmBP,GAC7B,IACA,EADY,0BACWM,KAAKD,GAC5B,MAAO,CAAEN,SAAQC,UAASC,OAD1B,uB,+DAKF,2CAAAtI,EAAA,sEACsBjC,IAAQ8K,aAD9B,OACEpL,KAAK+K,OADP,OAEQA,EAAS/K,KAAK+K,QACdM,EAAetH,SAASoB,cAAc,WAC/BmG,UAAYP,EACnBQ,EAASxH,SAASC,cAAc,UAChCwH,EAAK,IAAIC,IAETC,EAAQC,aAAY,WAAO,IAAD,EAC9B,UAAAJ,EAAOK,WAAW,aAAlB,SAAyBC,UAAUR,EAAc,EAAG,EAAGE,EAAO3C,MAAO2C,EAAOhD,QAC5EiD,EAAGM,OAAOP,EAAOQ,eAChB,KAEHP,EAAGQ,SAAW,SAAC5I,EAAY6I,IACrB7I,GAAU,kCAAkCZ,KAAKyJ,EAAOA,UAI5DC,cAAcR,GACdL,EAAac,QACb,EAAKC,cACL,EAAKjN,MAAMmJ,OAAO,EAAK+D,iBAAiBJ,EAAOA,WAGjDZ,EAAaiB,iBAAmB,SAACnM,GAC/BkL,EAAakB,OACbhB,EAAO3C,MAAQyC,EAAamB,WAC5BjB,EAAOhD,OAAS8C,EAAaoB,aA3BjC,iD,+EA+BA,WAAe,IAAD,EACZ,UAAAzM,KAAK+K,cAAL,SAAa2B,YAAYhD,SAAQ,SAAAiD,GAAC,OAAIA,EAAEC,Y,kEAG1C,sBAAArK,EAAA,sDACOvC,KAAKb,MAAM2B,SAASiI,cAGvB/I,KAAKoL,aAFLpL,KAAK0B,SAAS,CAAEsJ,qBAAqB,IAFzC,gD,0EAQA,WAAU,IAAD,OACP,OACE,cAAC,IAAD,CACEnJ,OAAQ7B,KAAKb,MAAM8I,UACnBtG,SAAS,SACTuG,cAAc,EAEdC,cAAa,sBAAE,sBAAA5F,EAAA,sDACb,EAAKsK,gBADQ,2CAGf1G,aAAc,WACZ,EAAKiG,cACL,EAAKjN,MAAMmJ,UAVf,SAYE,eAAC,IAAD,WACE,sBAAK/E,MAAO,CAAEe,QAAS,OAAQd,cAAe,SAAU+E,OAAQ,OAAQC,WAAY,UAApF,UACE,8BACE,cAAC,IAAD,CAAU9I,UAAU,SAApB,kEAEF,qBAAK6D,MAAO,CAAEkF,SAAU,EAAGC,WAAY,EAAGpE,QAAS,OAAQkE,WAAY,SAAUG,OAAQ,IAAzF,SACE,uBAAOvE,GAAG,QAAQwE,MAAM,OAAOrF,MAAO,CAAEoF,OAAQ,gBAElD,8BACE,cAAC,IAAD,CAAW5H,KAAK,UAAUC,MAAM,QAAQC,KAAK,QAAQC,QAAS,WAC5D,EAAKkL,cACL,EAAKjN,MAAMmJ,UAFb,+BAOJ,cAAC,IAAD,CACE3G,SAAS,SACTE,OAAQ7B,KAAKX,MAAM2L,oBACnBpJ,iBAAiB,EACjBE,OAAQ,+PACRK,QAAS,CACP,CACEC,KAAM,eACNT,SAAU,iBACVU,QAAS,SAACC,GACR,EAAKZ,SAAS,CACZsJ,qBAAqB,IAEvB,EAAK7L,MAAMsB,SAAS,CAClBC,KAAM,cACNC,IAAK,gBACLC,KAAK,IAEP,EAAKwK,2B,GAhHQ9E,IAAMC,WAmItBG,eARS,SAACrH,GACvB,MAAO,CACLyB,SAAUzB,EAAMyB,YAML4F,CAEboE,GC3IIgC,EAAQ,EAAIC,KAAKC,GAqBjBC,E,kDAIJ,WAAY9N,GAAa,IAAD,8BACtB,cAAMA,IAJR+N,sBAGwB,IAFxBC,qBAEwB,IAcxBvE,MAAQ,GAdgB,EAexBL,OAAS,GAfe,EAgBxB6E,WAhBwB,IAiBxBC,IAAMC,MAAiBC,WAAW,GAAGC,SAASV,GAAOW,YAAY,GAAGC,YAAY,EAAK9E,MAAQ,GAf3F,EAAKvJ,MAAQ,CACXsO,qBAAqB,EACrBC,OAAQ,GACRC,SAAS,EACTrO,WAAW,EACXC,aAAc,IAGhB,EAAKyN,iBAAmB,KACxB,EAAKC,gBAAkB7G,IAAMwH,YAXP,E,yDAmBxB,WACER,IAAa,mBAAmBS,iBAAiB5J,SACjD,IAAM6J,EAAIV,IAAa,mBACpBW,OAAO,OACPC,KAAK,QAASlO,KAAK4I,OACnBsF,KAAK,SAAUlO,KAAKuI,QACpB0F,OAAO,KACPC,KAAK,YALE,oBAKwBlO,KAAK4I,MAAQ,EALrC,aAK2C5I,KAAKuI,OAAS,EALzD,MAOVvI,KAAKoN,MAAQY,EAAEC,OAAO,QACnBC,KAAK,QAAS,yB,8BAGnB,WAAoB,IAAD,OAGjBlO,KAAKkN,iBAAmBvB,aAAY,WAAO,IAAD,EAClCwC,GAAY,IAAIC,MAAOC,aAAe,GAC5C,EAAK3M,SAAS,CACZkM,OAAQ,EAAKzO,MAAM2B,SAAS8F,UAAUa,KACpC,SAAAsC,GAAC,OAAIuE,IAAcC,cAAcxE,EAAEc,QAAQ2D,QAAQ,UAAW,YAGlE,YAAKpB,aAAL,SAAYc,KAAK,IAAK,EAAKb,IAAIE,WAAWT,EAAQqB,EAAW,GAAvC,CAA2C,MAChE,M,6BAGL,WACEnO,KAAKyO,0B,6BAGP,WAC+B,MAAzBzO,KAAKkN,kBACPhB,cAAclM,KAAKkN,oB,8BAIvB,SAAiBwB,GACf,IAAM9H,EAAY8H,EAAMrO,OAAOsO,SAAS3O,KAAKb,MAAM2B,SAAS8F,WAC5D5G,KAAKb,MAAMsB,SAAS,CAClBC,KAAM,mBACNkG,UAAWA,M,qBAIf,WAAW,IAAD,OACJgI,EAAO1H,QAyCX,OAxCAlH,KAAKb,MAAM2B,SAAS8F,UAAU8C,SAAQ,SAAC9E,EAAgBiK,GACrD,IAAMC,EAAQ,EAAKzP,MAAMuO,OAAOiB,GAChCD,EAAKxG,KACH,eAAC,IAAD,WACE,eAAC,IAAD,CAAS2G,QAAQ,EACf7N,QAAO,uCAAE,WAAMwN,GAAN,SAAAnM,EAAA,sDACPmM,EAAMM,iBACN1O,IAAQwH,gBAAgBgH,EAAMG,WAAW,IAAK,KAC9C,EAAKvN,SAAS,CAAElC,WAAW,EAAMC,aAAa,kCAHvC,2CAAF,sDADT,UAME,qBAAKE,SAAU,IACf,sBAAKD,UAAU,WAAf,UACE,8BACE,eAAC,IAAD,CAAUA,UAAU,uBAApB,UACGkF,EAAK+F,OADR,KACkB/F,EAAKgG,QADvB,SAIF,8BACE,cAAC,IAAD,CAAUsE,MAAM,UAAUxP,UAAU,2BAApC,SACGoP,GADiE,qBAAuBD,QAK/F,cAAC,IAAD,CAAUnP,UAAU,0CAA0C6D,MAAO,CAAEE,UAAW,UAAgB,qBAAuBoL,GAEzH,cAAC,IAAD,CAAY/O,KAAK,UArBS,WAAa+O,GAwBzC,cAAC,IAAD,CAAgBM,KAAK,MAArB,SACE,cAAC,IAAD,CAAezP,UAAU,SAASwP,MAAM,SAAShO,QAAS,SAACf,GAAO,IAAD,EAC/D,EAAKhB,MAAMsB,SAAS,CAClBC,KAAM,eACNsJ,KAAMpF,EAAKoF,OAEb,YAAKmD,gBAAgBiC,eAArB,SAA8BC,qBALhC,8BA1BiB,uBAAyBR,OAqC3CD,I,oBAGT,WAAU,IAAD,OACP,OACE,eAAC,IAAD,WACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAUlP,UAAU,SAApB,gCAEA,cAAC,IAAD,CAAWqB,KAAMf,KAAKX,MAAMwO,QAAU,QAAU,QAAS/N,KAAK,MAC5DoB,QAAS,SAAAsD,GAAE,OAAI,EAAK9C,SAAS,CAAEmM,SAAU,EAAKxO,MAAMwO,WADtD,SAEE,cAAC,IAAD,CAASjO,KAAM0P,IAAcxP,KAAK,qBAIxC,eAAC,IAAD,WAG6C,IAAzCE,KAAKb,MAAM2B,SAAS8F,UAAUS,OAC5B,cAAC,IAAD,CAAU3H,UAAU,WAApB,sHAEA,cAAC,IAAD,CAAS6P,IAAKvP,KAAKmN,gBAAnB,SACE,cAAC,IAAD,CAAiBqC,UAAWxP,KAAKX,MAAMwO,QAAS4B,iBAAkB,SAACf,GAAiD,EAAKgB,iBAAiBhB,IAA1I,SACG1O,KAAK2P,cAKd,cAAC,IAAD,CAAQC,SAAS,SAASC,WAAW,MAAM/P,KAAK,QAAhD,SACE,cAAC,IAAD,CACEoB,QAAS,SAAAf,GACP,EAAKuB,SAAS,CAAEiM,qBAAqB,KAFzC,SAKE,cAAC,IAAD,CAAS/N,KAAMkQ,UAInB,cAACC,EAAD,4BAEI9H,UAAWjI,KAAKX,MAAMsO,oBACtBrF,OAAQ,SAAC2D,GAGP,GAFA,EAAKvK,SAAS,CAAEiM,qBAAqB,IAEvB,MAAV1B,EAAJ,CAGA,IAAQtB,EAA4BsB,EAA5BtB,OAAQC,EAAoBqB,EAApBrB,QAASC,EAAWoB,EAAXpB,OAEzB,EAAK1L,MAAMsB,SAAS,CAClBC,KAAM,eACNiJ,SAAU,IAAIc,EAAS,CACrBT,KAAMgG,cACNrF,SACAC,UACAC,aAIJ,EAAK4D,2BACDzO,KAAKb,SAIf,cAAC,IAAD,CACEwC,SAAS,SACTE,OAAQ7B,KAAKX,MAAMG,UACnB2G,aAAc,kBAAM,EAAKzE,SAAS,CAAElC,WAAW,KAC/C4G,QAASpG,KAAKX,MAAMI,aACpB4G,SAAU,gB,GApLEC,IAAMC,WA4LxB0J,EAAWxJ,YAAiBwG,GAYnBvG,iBAVS,SAACrH,GACvB,MAAO,CACL6Q,cAAe7Q,EAAM0H,YAAYmJ,cACjCnJ,YAAa1H,EAAM0H,YACnBjG,SAAUzB,EAAMyB,YAML4F,CAEbuJ,I,oBChPF,IAAIxI,EAAM,CACT,8BAA+B,CAC9B,IACA,GAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,GAED,0BAA2B,CAC1B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,sBAAuB,CACtB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,qBAAsB,CACrB,IACA,IAED,mCAAoC,CACnC,IACA,IAED,uBAAwB,CACvB,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,IAED,yBAA0B,CACzB,IACA,GAED,8BAA+B,CAC9B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,sBAAuB,CACtB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,gCAAiC,CAChC,IACA,KAGF,SAAS0I,EAAoBC,GAC5B,IAAIC,EAAoBC,EAAE7I,EAAK2I,GAC9B,OAAOG,QAAQC,UAAUC,MAAK,WAC7B,IAAItQ,EAAI,IAAI6E,MAAM,uBAAyBoL,EAAM,KAEjD,MADAjQ,EAAEuQ,KAAO,mBACHvQ,KAIR,IAAIwQ,EAAMlJ,EAAI2I,GAAMhM,EAAKuM,EAAI,GAC7B,OAAON,EAAoBlQ,EAAEwQ,EAAI,IAAIF,MAAK,WACzC,OAAOJ,EAAoBjM,MAG7B+L,EAAoB/I,KAAO,WAC1B,OAAOD,OAAOC,KAAKK,IAEpB0I,EAAoB/L,GAAK,IACzBwM,EAAOC,QAAUV,G,oBChMjB,IAAI1I,EAAM,CACT,sBAAuB,CACtB,IACA,KAGF,SAAS0I,EAAoBC,GAC5B,IAAIC,EAAoBC,EAAE7I,EAAK2I,GAC9B,OAAOG,QAAQC,UAAUC,MAAK,WAC7B,IAAItQ,EAAI,IAAI6E,MAAM,uBAAyBoL,EAAM,KAEjD,MADAjQ,EAAEuQ,KAAO,mBACHvQ,KAIR,IAAIwQ,EAAMlJ,EAAI2I,GAAMhM,EAAKuM,EAAI,GAC7B,OAAON,EAAoBlQ,EAAEwQ,EAAI,IAAIF,MAAK,WACzC,OAAOJ,EAAoBjM,MAG7B+L,EAAoB/I,KAAO,WAC1B,OAAOD,OAAOC,KAAKK,IAEpB0I,EAAoB/L,GAAK,IACzBwM,EAAOC,QAAUV,G,mbCZXW,EAAcC,QACW,cAA7BC,OAAOC,SAASC,UAEa,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MAAM,2DA0CjC,SAASC,EAAgBC,EAAeC,GACtCnQ,UAAUoQ,cACPC,SAASH,GACTZ,MAAK,SAACgB,GAQLA,EAAaC,cAAgB,WAE3B,IAAMC,EAAmBF,EAAaG,WACd,MAApBD,IAGJA,EAAiBE,cAAgB,WAC/B1O,QAAQ2O,IAAR,0CAA+CH,EAAiBtS,QACjC,cAA3BsS,EAAiBtS,QACf8B,UAAUoQ,cAAcQ,YAI1B5O,QAAQ2O,IACN,+GAKER,GAAUA,EAAOU,UACnBV,EAAOU,SAASP,KAMlBtO,QAAQ2O,IAAI,sCAGRR,GAAUA,EAAOW,WACnBX,EAAOW,UAAUR,WAO5BS,OAAM,SAAA9O,GACLD,QAAQC,MAAM,4CAA6CA,M,WCpGjE9C,IAAQC,eAER4R,IAASC,OAAO,cAAC,IAAD,UAAe,cAACC,EAAA,EAAD,MAAyBtO,SAASmB,eAAe,SDezE,SAAkBoM,GACvB,GAA6C,kBAAmBnQ,UAAW,CAGzE,GADkB,IAAImR,IAAIC,YAAwBvB,OAAOC,SAAShN,MACpDuO,SAAWxB,OAAOC,SAASuB,OAIvC,OAGFxB,OAAOyB,iBAAiB,QAAQ,WAC9B,IAAMpB,EAAK,UAAMkB,YAAN,sBAEPzB,IAyEV,SAAiCO,EAAeC,GAE9CoB,MAAMrB,EAAO,CACXsB,QAAS,CAAE,iBAAkB,YAE5BlC,MAAK,SAAAmC,GAEJ,IAAMC,EAAcD,EAASD,QAAQG,IAAI,gBAEnB,MAApBF,EAASG,QACO,MAAfF,IAA8D,IAAvCA,EAAYG,QAAQ,cAG5C7R,UAAUoQ,cAAc0B,MAAMxC,MAAK,SAACgB,GAClCA,EAAayB,aAAazC,MAAK,WAC7BO,OAAOC,SAASkC,eAKpB/B,EAAgBC,EAAOC,MAG1BY,OAAM,WACL/O,QAAQ2O,IAAI,oEA/FVsB,CAAwB/B,EAAOC,GAI/BnQ,UAAUoQ,cAAc0B,MAAMxC,MAAK,WACjCtN,QAAQ2O,IACN,+GAMJV,EAAgBC,EAAOC,OCtC/BC,CAAuB,CACnBU,UAAW,SAACR,GAA8CtO,QAAQ2O,IAAI,wBAAyBuB,IAAqBpB,UAAUR,IAC9HO,SAAU,SAACP,GAA8CtO,QAAQ2O,IAAI,sBAAuBuB,IAAqBrB,SAASP,O,wECfxH6B,EAASf,YAGTgB,EAAa,aACfzB,EAAM,G,4CAEV,WAAoC0B,GAApC,eAAAjR,EAAA,6DACQkR,EAAYC,UAAUC,KAAKJ,GADnC,kBAGS,IAAIhD,SAAQ,SAAUqD,EAAIC,GAC/BJ,EAAUK,UAAV,uCAAsB,WAAgBtP,GAAhB,mBAAAjC,EAAA,sDACdwR,EAAKN,EAAUxH,OAErB,IACQ+H,EAAQD,EAAGE,YAAY,CAAC,SAAU,cACpC7D,EAAM4D,EAAME,YAAY,SAASpB,IAAIU,IACrCM,UAAJ,uCAAgB,WAAgBK,GAAhB,eAAA5R,EAAA,yDACR6R,EAAOhE,EAAInE,OADH,uBAGZ9I,QAAQC,MAAR,UAAiBoQ,EAAjB,qBACArQ,QAAQC,OAAM,IAAI4B,OAAQC,OAJd,kBAKL4O,KALK,gCAOPD,EAAGQ,IAPI,2CAAhB,sDASA,MAAOC,GACPlR,QAAQC,MAAMiR,GAhBI,2CAAtB,0DAJJ,4C,kEA0BA,WAAmCb,EAAkBY,GAArD,eAAA7R,EAAA,6DACQkR,EAAYC,UAAUC,KAAKJ,GADnC,kBAES,IAAIhD,SAAc,SAACqD,EAAIC,GAC5BJ,EAAUK,UAAV,uCAAsB,WAAOtP,GAAP,mBAAAjC,EAAA,sDACdwR,EAAKN,EAAUxH,OAEfqI,EAAaP,EAAGE,YAAY,CAAC,SAAU,cACvCM,EAAWD,EAAWJ,YAAY,SAASM,IAAIJ,EAAMZ,IAClDM,UAAY,SAACK,GAAD,OAAcP,KACnCW,EAASE,QAAU,SAACN,GAAD,OAAcN,KANb,2CAAtB,0DAHJ,4C,kEAcA,WAAuCL,GAAvC,eAAAjR,EAAA,6DACQkR,EAAYC,UAAUC,KAAKJ,GADnC,kBAES,IAAIhD,SAAc,SAACqD,EAAIC,GAC5B,IACEJ,EAAUK,UAAY,SAACtP,GACrB,IAEM8P,EAFKb,EAAUxH,OAECgI,YAAY,CAAC,SAAU,aAC7C,IACE,IAAMM,EAAWD,EAAWJ,YAAY,SAASQ,OAAOlB,GACxDe,EAAST,UAAY,SAACK,GAAD,OAAcP,KACnCW,EAASE,QAAU,SAACN,GAAD,OAAcN,KACjC,MAAOQ,GACPlR,QAAQC,MAAMiR,KAGlB,MAAOA,GACPR,EAAKQ,QAjBX,4C,+BAsBeM,I,2EAAf,4BAAApS,EAAA,6DACQkR,EAAYC,UAAUC,KAAKJ,GADnC,kBAES,IAAIhD,SAAc,SAACqD,EAAIC,GAC5BJ,EAAUK,UAAV,uCAAsB,WAAOtP,GAAP,mBAAAjC,EAAA,sDACdwR,EAAKN,EAAUxH,OAEfqI,EAAaP,EAAGE,YAAY,CAAC,SAAU,cACvCM,EAAWD,EAAWJ,YAAY,SAASU,SACxCd,UAAY,SAACK,GAAD,OAAcP,KACnCW,EAASE,QAAU,SAACN,GAAD,OAAcN,KANb,2CAAtB,0DAHJ,4C,kEAcA,sBAAAtR,EAAA,6DACEqB,aAAagR,QADf,SAEQD,IAFR,4C,kEAKA,sBAAApS,EAAA,+EACS,IAAIgO,SAA6B,SAACqD,EAAIC,GACtC1S,UAAU0T,YAGb1T,UAAU0T,YAAYC,oBAAmB,SAACC,GACxCnB,EAAGmB,MACF,SAAC3R,GACFyQ,EAAK,GAAD,OAAIzQ,EAAMsN,KAAV,aAAmBtN,EAAMgD,aAL/ByN,EAAK,8BAHX,4C,sBAcA,IAAMmB,EAAUhE,OAAegE,OAC/B,SAASC,IAAe,IAAD,EACrB,OAAwD,OAA3C,OAAND,QAAM,IAANA,GAAA,UAAAA,EAAQE,uBAAR,eAAyBC,sBAGlC,IAAIC,GAAqB,EACrBC,EAAmB,E,4CAMvB,sBAAA9S,EAAA,mEAEQ0S,IAFR,gCAGY,IAAI1E,QAAJ,uCAAkB,WAAOqD,EAAIC,GAAX,eAAAtR,EAAA,sDACtB6S,GAAqB,EACrBJ,EAAOE,gBAAgBC,qBAAqBG,YAAY,CACtD5G,MAAO,WAGHhD,EAAQC,aAAY,WACnByJ,IACHlJ,cAAcR,GAEV2J,EACFxB,IAEAD,OAGH,KAhBmB,2CAAlB,yDAHZ,uBAuBiBzS,UAAUoU,aAAaC,aAAa,CAC/CC,MAAO,CAAE7M,MAAO,IAAKL,OAAQ,KAAMmN,WAAY,iBAxBrD,8EA2BIvS,QAAQC,MAAR,MA3BJ,+D,sBALC4N,OAAe2E,qBAAuB,SAACjF,GACtC2E,EAAmB3E,EACnB0E,GAAqB,GA4CvB,IAAMQ,EAAazS,QAAQ2O,IAAI+D,KAAK1S,SAC9B2S,EAAe3S,QAAQC,MAAMyS,KAAK1S,SAoDxC,SAAS4S,IACP,OAAOC,YAAW,QAAiC,aAAvB7U,UAAU8U,SAGxC,IAAM3V,EAAU,CACdgT,SACAvQ,gBApNsB,8EAqNtBe,UAAW,wBACXgR,mB,2CACA1J,W,2CACA3J,OA5DF,WACE,OAAOqQ,GA4DPvR,aAzDF,WACE4C,QAAQ2O,IAAM,WACZA,GAAO,oBACPA,GAAQ5K,MAAMgP,KAAKC,WAAc,KACjCP,EAAWQ,MAAMjT,QAASgT,YAG5BhT,QAAQC,MAAQ,WACd0O,GAAO,qBACPA,GAAQ5K,MAAMgP,KAAKC,WAAc,KACjCL,EAAaM,MAAMjT,QAASgT,aAgD9B3V,cA5CF,WACEsR,EAAM,GACN3O,QAAQ2O,IAAM8D,EACdzS,QAAQC,MAAQ0S,GA0ChBvC,aACAhO,YAAa,CACX,MAAS,2BACT,WAAc,+BAEhB8Q,kBACE,qBAAK3W,UAAU,gBAAf,SACE,cAAC,IAAD,UACE,gCACE,4DACA,sBAAK6D,MAAO,CAAE+S,SAAU,sBAAuBC,WAAY,IAA3D,qFAA6E,mBAAGtS,KAAI,WAAMqP,EAAN,aAAyB5O,OAAO,QAAvC,gCAA7E,kEAKR8R,UAAW,WACT,OAAO,IAAIjG,QAAJ,uCAAY,WAAMC,GAAN,SAAAjO,EAAA,sDACjBpB,UAAUoQ,cAAckF,mBAAmBhG,KAA3C,uCAAgD,WAAMiG,GAAN,eAAAnU,EAAA,sEACrBgO,QAAQoG,IAAID,EAAKjP,KAAI,SAAAmP,GAAG,OAAKA,EAAIC,SAAiBpG,MAAK,SAACqG,GAC/E,OAA6B,OAAtBA,EAAOlF,YAA0C,OAAnBkF,EAAOC,eAFA,OACxCC,EADwC,OAI9CxG,EAAQwG,EAAWC,QAAO,SAACC,EAAMC,GAAP,OAAgBD,GAAQC,KAAM,IAJV,2CAAhD,uDADiB,2CAAZ,wDASTlR,cAAe,SAACnF,GACdiD,SAASqT,gBAAgB7T,MAAM8T,QAA/B,0BAA4DvW,EAAS6E,WAArE,QAEFoQ,gBACAuB,cAAe,WACb,OAAQtB,YAAW,SAAWD,KAAoBC,YAAW,YAE/DuB,YAAa,WACX,OAAOvB,YAAW,QAAUA,YAAW,aAEzCf,cACAuC,qB,4CACAC,oB,8CACAC,wB,4CACArS,a,2CACAsS,0BAjHF,SAAmCC,EAAelY,GAEhD,IADA,IAAImY,EAAWD,EAAIE,uBAAuBpY,GACnCmY,EAASxQ,OAAS,GAAG,CAAC,IAAD,EAC1B,UAAAwQ,EAAS,GAAGE,kBAAZ,SAAwBC,YAAYH,EAAS,MA+G/CI,4BAhFF,SAAqCvJ,GAGnC,OAFAA,EAAMM,iBACNN,EAAMwJ,mBACC,GA8EPC,wBA1EF,SAA+CzJ,GAC7C,IAAM0J,EAAIpY,KAAKqY,eACf,KAAM,OAADD,QAAC,IAADA,OAAA,EAAAA,EAAGE,aAAc,GAAK,EAAG,CAC5B,IAAMC,EAAC,OAAGH,QAAH,IAAGA,OAAH,EAAGA,EAAGI,WAAW,GACvB,OAADJ,QAAC,IAADA,KAAGK,kBACHC,YAAW,WACR,OAADN,QAAC,IAADA,KAAGO,SAASJ,KACX,MAoELzQ,gBAhEF,SAAyB1F,GACvB,IACEjB,UAAUyX,WAAazX,UAAUyX,UAAUC,UAAUzW,GACrD,MAAOgB,GACPD,QAAQC,MAAMA,MA+DH9C,O,4VC/NTwY,EAA2B9H,OAAe8H,mBAE5CC,EAAQ1O,cAgBZ2O,YAAY,CACVC,KAAM,KACNC,kBAAkB,IAGb,IAAI7F,EAAuB,CAChCpB,UAAW,SAAUR,KACrBO,SAAU,SAAUP,MA2BhB0H,E,4JACJ,WACE,OACE,cAAC,IAAD,CAAUJ,MAAOA,EAAjB,SACE,cAACK,EAAD,eAAapZ,KAAKb,c,GAJPmH,IAAMC,WAUnB8S,E,kDAIJ,WAAYla,GAAa,IAAD,EA6BtB,IA7BsB,qBACtB,cAAMA,IAJRma,qBAGwB,IAFxBC,4BAEwB,IAmGxBC,cAnGwB,EAEjB,EAAKra,MAAM2B,SAASb,WACvBK,IAAQE,gBAGQ,OAAlBsY,QAAkB,IAAlBA,KAAoBW,QAAQ,YAAY,SAACrF,GACvC,OAAQA,EAAK1F,OACX,IAAK,UACHqK,EAAMtY,SAAS,CACbC,KAAM,kBACNC,IAAK,cACLC,IAAKwT,EAAKtL,cAKA,OAAlBgQ,QAAkB,IAAlBA,KAAoBY,KAAK,SAAU,CAAEhL,MAAO,UAE5C,EAAK4K,gBAAkB,KAEnBtD,YAAW,WACbhF,OAAO2I,cAAgBrZ,IAAQ2X,4BACtBjC,YAAW,SACpBjS,SAAS6V,WAAatZ,IAAQ6X,wBAAwBtC,KAAK7E,SAKtDjN,SAASmF,KAAKC,UAAU9B,OAAS,GACtCtD,SAASmF,KAAKC,UAAUhF,OAAOJ,SAASmF,KAAKC,UAAUvE,KAAK,IAE9Db,SAASmF,KAAKC,UAAUC,OAAxB,eAAuC,EAAKjK,MAAM2B,SAAS0E,QAAS,GAGpE,IAAMqU,EAAcC,IAAYhV,MAAM,EAAK3F,MAAM8R,SAAS8I,QAnCpC,OAoClBF,EAAY/Y,WACd,EAAKyY,uBAAyB3V,aAAaC,QAAQvD,IAAQwD,WAC1D+V,EAAY/Y,SAAoBkZ,MAAM,KAAKtQ,SAAQ,SAAAuQ,GAClD,IAAMvS,EAASuS,EAAQD,MAAM,KAC7B,EAAK7a,MAAMsB,SAAS,CAClBC,KAAM,cACNC,IAAK+G,EAAO,GACZ9G,KAAM8G,EAAO,SAInB1B,GAAa,WACX1F,IAAQ2F,cAAc,EAAK9G,MAAM2B,aAGnC,EAAKzB,MAAQ,CACX6a,iBAAiB,EACjBC,4BAAsD,MAAxBN,EAAY/Y,UAAmD,MAA/B,EAAKyY,yBAAmC,EACtG/Z,WAAW,EACXC,aAAc,IAGhB4T,EAAqBrB,SAAW,SAACP,GAC/B,EAAK6H,gBAAkB7H,EACvB,EAAK/P,SAAS,CAAEwY,iBAAiB,KAGnC7G,EAAqBpB,UAAY,SAACR,KAIH,qBAApB2I,kBACTA,gBAAgBC,YAChBD,gBAAgBE,UAIbnZ,UAAkBqY,WACrB,EAAKe,iBACLxW,SAAS0O,iBAAiB,mBAA1B,sBAA8C,sBAAAlQ,EAAA,sDACX,YAA7BwB,SAASyW,gBACX,EAAKD,iBAEL,EAAKE,wBAJqC,6CAS9B/G,UAAUC,KAAKrT,IAAQiT,YAE/BmH,gBAAkB,SAAUhM,GAC1BA,EAAMhK,OAAeuH,OAC5B0O,kBAAkB,SACrBxX,QAAQ2O,IAAR,sBAzFoB,E,sDA6FxB,WACElO,aAAamB,QAAQzE,IAAQwD,UAAW9D,KAAKuZ,wBAC7CvZ,KAAKb,MAAMsB,SAAS,CAAEC,KAAM,oB,mEAK9B,4BAAA6B,EAAA,kEAGoB,OADViX,EAAYrY,UAAkBqY,UAFxC,gCAI4BA,EAASoB,QAAQ,UAJ7C,OAIM5a,KAAKwZ,SAJX,OAKMrW,QAAQ2O,IAAI,kCALlB,uBAOM3O,QAAQC,MAAM,oCAPpB,0DAWID,QAAQ2O,IAAR,UAAe,KAAI7P,KAAnB,aAA4B,KAAImE,UAChCjD,QAAQ2O,KAAI,IAAI9M,OAAQC,OAZ5B,0D,gIAgBA,sBAAA1C,EAAA,yDACuB,MAAjBvC,KAAKwZ,SADX,gCAEUxZ,KAAKwZ,SAASqB,UAFxB,OAGI7a,KAAKwZ,SAAW,KAChBrW,QAAQ2O,IAAI,iCAJhB,gD,sFAQA,WASE3O,QAAQ2O,IAAId,OAAOC,SAAS8I,QAC5B,IAAMe,EAAe,gBAAgB5P,KAAK8F,OAAOC,SAAS8I,QACpDgB,EAAe,gBAAgB7P,KAAK8F,OAAOC,SAAS8I,QAC1D,GAAqB,OAAjBe,EAAuB,CACzB,IAAME,EAAQ7P,mBAAmB2P,EAAa,IAE1CG,EAAQ,GAIZ,OAHqB,OAAjBF,IACFE,EAAQ9P,mBAAmB4P,EAAa,KAEnC,cAAC,IAAD,CAAUG,GAAI,UAAG5a,IAAQgT,QAAW0H,EAAQC,IAC9C,GAAIjK,OAAOC,SAASkK,WAAhB,UAAgC7a,IAAQgT,OAAxC,MAAqDtC,OAAOC,SAASkK,WAAhB,UAAgC7a,IAAQgT,QACtG,OAAO,cAAC,IAAD,CAAU4H,GAAE,UAAK5a,IAAQgT,OAAb,a,oBAIvB,WAAU,IAAD,WACP,OACE,eAAC,IAAD,WACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,eAAC,IAAD,CAAiB8H,UAAU,EAA3B,UAEE,cAAC,IAAD,CAAOC,KAAI,UAAK/a,IAAQgT,OAAb,SAA4BlB,OAAQ,SAACjT,GAAD,OAAgB,cAAC,IAAD,eAAcA,KAAWmc,OAAO,IAC/F,cAAC,IAAD,CAAOD,KAAI,UAAK/a,IAAQgT,OAAb,aAAgClB,OAAQ,SAACjT,GAAD,OAAgB,cAAC,IAAD,eAAkBA,OACrF,cAAC,IAAD,CAAOkc,KAAI,UAAK/a,IAAQgT,OAAb,KAAwBlB,OAAQ,WAAQ,OAAO,EAAKmJ,sBAAyBD,OAAO,OAEjG,eAAC,IAAD,CAAWxb,KAAK,SAAhB,UACE,cAAC,IAAD,CAAc0b,IAAI,OAAOvX,KAAI,UAAK3D,IAAQgT,OAAb,SAA7B,SACE,cAAC,IAAD,CAAS1T,KAAMe,QAEjB,cAAC,IAAD,CAAc6a,IAAI,WAAWvX,KAAI,UAAK3D,IAAQgT,OAAb,aAAjC,SACE,cAAC,IAAD,CAAS1T,KAAMkB,gBAKvB,cAAC,IAAD,CACEa,SAAS,SACTE,OAAQ7B,KAAKX,MAAM6a,gBACnBtY,iBAAiB,EACjBwD,aAAc,SAACZ,GAAQ,IAAD,QAGpB,YAAK8U,uBAAL,mBAAsB1H,kBAAtB,SAAkC0D,YAAY,CAAE5U,KAAM,iBACtD,YAAK4Y,uBAAL,mBAAsBvC,eAAtB,SAA+BzB,YAAY,CAAE5U,KAAM,kBAErDoB,OAAQ,kDACRK,QAAS,CACP,CACEC,KAAM,eACNT,SAAU,iBACVU,QAAS,SAACC,GACR,EAAKZ,SAAS,CACZwY,iBAAiB,SAO3B,cAAC,IAAD,4BAEI9X,KAAI,UAAEpC,KAAKb,MAAMmK,sBAAb,aAAE,EAA2BlH,KACjC6F,WAAW,UAAAjI,KAAKb,MAAMmK,sBAAX,eAA2BC,QAAQ,EAC9CjB,OAAQ,WACNyQ,EAAMtY,SAAS,CACbC,KAAM,kBACNC,IAAK,iBACLC,IAAK,CAAE2I,MAAM,OAEXvJ,KAAKb,SAIf,cAAC,IAAD,CACEwC,SAAS,SACTE,OAAQ7B,KAAKX,MAAM8a,4BACnBhU,aAAc,kBAAM,EAAKzE,SAAS,CAAEyY,6BAA6B,KACjE/T,QAAO,4GACPjE,QAAS,CACP,CACEC,KAAM,eACNiB,KAAM,SACNhB,QAAS,kBAAM,EAAKX,SAAS,CAAEyY,6BAA6B,MAE9D,CACE/X,KAAM,eACNC,QAAS,kBAAM,EAAKoZ,0BAK1B,cAAC,IAAD,CACE9Z,SAAS,SACTE,OAAQ7B,KAAKX,MAAMG,UACnB2G,aAAc,kBAAM,EAAKzE,SAAS,CAAElC,WAAW,KAC/C4G,QAASpG,KAAKX,MAAMI,aACpB4G,SAAU,a,GA3OGC,IAAMC,WA0PvB6S,EAAU1S,aARQ,SAACrH,GACvB,MAAO,CACLiK,eAAgBjK,EAAM0H,YAAYuC,eAClCxI,SAAUzB,EAAMyB,SAChBiG,YAAa1H,EAAM0H,eAIPL,CAEd2S,GAGIhH,EAAMqJ,YAAWvC,GAER9G,Q","file":"static/js/main.fd42cbbe.chunk.js","sourcesContent":["import React from 'react';\nimport { IonContent, IonHeader, IonPage, IonTitle, IonToolbar, IonList, IonItem, IonRange, IonIcon, IonLabel, IonToggle, IonButton, IonAlert, IonSelect, IonSelectOption, IonToast, withIonLifeCycle } from '@ionic/react';\nimport { connect } from 'react-redux';\nimport { RouteComponentProps } from 'react-router-dom';\nimport axios from 'axios';\n\nimport Globals from '../Globals';\nimport { helpCircle, text, colorPalette, bug, download } from 'ionicons/icons';\nimport './SettingsPage.css';\nimport PackageInfos from '../../package.json';\n\ninterface StateProps {\n  showBugReportAlert: boolean;\n  showClearAlert: boolean;\n  showToast: boolean;\n  toastMessage: string;\n}\n\ninterface Props {\n  dispatch: Function;\n  hasAppLog: boolean;\n  theme: number;\n  uiFontSize: number;\n  settings: any;\n  voiceURI: string;\n  speechRate: number;\n  mainVersion: string | null;\n  cbetaOfflineDbMode: boolean;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  tab: string;\n  path: string;\n  label: string;\n}> { }\n\nclass _SettingsPage extends React.Component<PageProps, StateProps> {\n  constructor(props: any) {\n    super(props);\n\n    this.state = {\n      showBugReportAlert: false,\n      showClearAlert: false,\n      showToast: false,\n      toastMessage: '',\n    };\n  }\n\n  ionViewWillEnter() {\n  }\n\n  reportText = '';\n  render() {\n    return (\n      <IonPage>\n        <IonHeader>\n          <IonToolbar>\n            <IonTitle className='uiFont'>設定</IonTitle>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n          <IonList>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={bug} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'>啟用 app 異常記錄</IonLabel>\n              <IonToggle slot='end' checked={this.props.hasAppLog} onIonChange={e => {\n                const isChecked = e.detail.checked;\n\n                if (this.props.hasAppLog === isChecked) {\n                  return;\n                }\n\n                isChecked ? Globals.enableAppLog() : Globals.disableAppLog();\n                this.props.dispatch({\n                  type: \"SET_KEY_VAL\",\n                  key: 'hasAppLog',\n                  val: isChecked\n                });\n              }} />\n            </IonItem>\n            <IonItem hidden={!this.props.settings.hasAppLog}>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={bug} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'>回報 app 異常記錄</IonLabel>\n              <IonButton fill='outline' shape='round' slot='end' size='large' className='uiFont' onClick={e => {\n                this.reportText = \"瀏覽器：\" + navigator.userAgent + \"\\n\\nApp版本：\" + PackageInfos.pwaVersion + \"\\n\\nApp設定：\" + JSON.stringify(this.props.settings) + \"\\n\\nLog：\\n\" + Globals.getLog();\n                this.setState({ showBugReportAlert: true });\n              }}>回報</IonButton>\n              <IonAlert\n                cssClass='uiFont'\n                backdropDismiss={false}\n                isOpen={this.state.showBugReportAlert}\n                header={'異常回報'}\n                subHeader='輸入您的 E-mail，以後續聯絡'\n                inputs={[\n                  {\n                    name: 'name0',\n                    type: 'email',\n                    placeholder: '例：abc@example.com'\n                  },\n                  {\n                    name: 'name1',\n                    type: 'textarea',\n                    placeholder: '請描述發生步驟'\n                  },\n                ]}\n                buttons={[\n                  {\n                    text: '送出',\n                    cssClass: 'primary uiFont',\n                    handler: async (value) => {\n                      if (!/^\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$/.test(value.name0)) {\n                        this.setState({ showBugReportAlert: false, showToast: true, toastMessage: `錯誤，E-mail 不符格式！` });\n                        return\n                      }\n\n                      try {\n                        const axiosInstance = axios.create({ timeout: 10000 });\n                        await axiosInstance.post(Globals.bugReportApiUrl, {\n                          subject: `${PackageInfos.productName}異常記錄回報`,\n                          text: `E-mail: ${value.name0}\\n\\n發生步驟: ${value.name1}\\n\\n${this.reportText}`,\n                        });\n                        this.setState({ showBugReportAlert: false, showToast: true, toastMessage: `異常回報成功` });\n                      } catch (error) {\n                        console.error(error);\n                        this.setState({ showBugReportAlert: false, showToast: true, toastMessage: `異常回報失敗` });\n                      }\n                    },\n                  },\n                  {\n                    text: '取消',\n                    role: 'cancel',\n                    cssClass: 'secondary uiFont',\n                    handler: () => this.setState({ showBugReportAlert: false }),\n                  },\n                ]}\n              />\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={download} slot='start' />\n              <div className='contentBlock'>\n                <div style={{ flexDirection: 'column' }}>\n                  <IonLabel className='ion-text-wrap uiFont'>App 設定</IonLabel>\n                  <div style={{ textAlign: 'right' }}>\n                    <IonButton fill='outline' shape='round' size='large' className='uiFont' onClick={async (e) => {\n                      const settingsJsonUri = `data:text/json;charset=utf-8,${encodeURIComponent(localStorage.getItem(Globals.storeFile) || '')}`;\n                      const a = document.createElement('a');\n                      a.href = settingsJsonUri;\n                      a.download = Globals.storeFile;\n                      a.click();\n                      a.remove();\n                    }}>匯出</IonButton>\n                    <input id='importJsonInput' type='file' accept='.json' style={{ display: 'none' }} onChange={async (ev) => {\n                      const file = ev.target.files?.item(0);\n                      const fileText = await file?.text() || '';\n                      try {\n                        // JSON text validation.\n                        JSON.parse(fileText);\n                        localStorage.setItem(Globals.storeFile, fileText);\n                        this.props.dispatch({ type: 'LOAD_SETTINGS' });\n                      } catch (e) {\n                        console.error(e);\n                        console.error(new Error().stack);\n                      }\n                      (document.getElementById('importJsonInput') as HTMLInputElement).value = '';\n                    }} />\n\n                    <IonButton fill='outline' shape='round' size='large' className='uiFont' onClick={(e) => {\n                      (document.querySelector('#importJsonInput') as HTMLInputElement).click();\n                    }}>匯入</IonButton>\n                    <IonButton fill='outline' shape='round' size='large' className='uiFont' onClick={(e) => {\n                      this.setState({ showClearAlert: true });\n                    }}>重置</IonButton>\n                    <IonAlert\n                      cssClass='uiFont'\n                      isOpen={this.state.showClearAlert}\n                      backdropDismiss={false}\n                      onDidPresent={(ev) => {\n                      }}\n                      header={'重置會還原app設定預設值並清除書籤、離線資料檔！確定重置？'}\n                      buttons={[\n                        {\n                          text: '取消',\n                          cssClass: 'primary uiFont',\n                          handler: (value) => {\n                            this.setState({\n                              showClearAlert: false,\n                            });\n                          },\n                        },\n                        {\n                          text: '重置',\n                          cssClass: 'secondary uiFont',\n                          handler: async (value) => {\n                            await Globals.clearAppData();\n                            this.props.dispatch({ type: 'DEFAULT_SETTINGS' });\n                            this.setState({ showClearAlert: false, showToast: true, toastMessage: \"清除成功!\" });\n                          },\n                        }\n                      ]}\n                    />\n                  </div>\n                </div>\n              </div>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={colorPalette} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'>{Globals.appSettings['theme']}</IonLabel>\n              <IonSelect slot='end'\n                value={+this.props.theme}\n                className='uiFont'\n                interface='popover'\n                interfaceOptions={{ cssClass: 'TwoFauththemes' }}\n                onIonChange={e => {\n                  const value = +e.detail.value;\n                  // Important! Because it can results in rerendering of this component but\n                  // store states (this.props.theme) of this component is not updated yet! And IonSelect value will be changed\n                  // back to the old value and onIonChange will be triggered again!\n                  // Thus, we use this check to ignore this invalid change.\n                  if (+this.props.theme === value) {\n                    return;\n                  }\n\n                  this.props.dispatch({\n                    type: \"SET_KEY_VAL\",\n                    key: 'theme',\n                    val: value,\n                  });\n                }}>\n                <IonSelectOption className='uiFont cbeta' value={0}>綠底</IonSelectOption>\n                <IonSelectOption className='uiFont dark' value={1}>暗色</IonSelectOption>\n                <IonSelectOption className='uiFont light' value={2}>亮色</IonSelectOption>\n                <IonSelectOption className='uiFont oldPaper' value={3}>舊書</IonSelectOption>\n                <IonSelectOption className='uiFont marble' value={4}>大理石</IonSelectOption>\n              </IonSelect>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={text} slot='start' />\n              <div className=\"contentBlock\">\n                <div style={{ flexDirection: \"column\" }}>\n                  <IonLabel className='ion-text-wrap uiFont'>{Globals.appSettings['uiFontSize']}: {this.props.uiFontSize}</IonLabel>\n                  <IonRange min={12} max={32} pin={true} snaps={true} value={this.props.uiFontSize} onIonChange={e => {\n                    this.props.dispatch({\n                      type: \"SET_KEY_VAL\",\n                      key: 'uiFontSize',\n                      val: +e.detail.value,\n                    });\n                    setImmediate(() => {\n                      Globals.updateCssVars(this.props.settings);\n                    });\n                  }} />\n                </div>\n              </div>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={helpCircle} slot='start' />\n              <div className='uiFont'>\n                <div>關於</div>\n                <div>作者: Meng-Yuan Huang</div>\n                <div><a href=\"mailto:myh@live.com\" target=\"_new\">myh@live.com</a></div>\n              </div>\n            </IonItem>\n          </IonList>\n\n          <IonToast\n            cssClass='uiFont'\n            isOpen={this.state.showToast}\n            onDidDismiss={() => this.setState({ showToast: false })}\n            message={this.state.toastMessage}\n            duration={2000}\n          />\n        </IonContent>\n      </IonPage >\n    );\n  }\n};\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    settings: state.settings,\n    hasAppLog: state.settings.hasAppLog,\n    theme: state.settings.theme,\n    uiFontSize: state.settings.uiFontSize,\n    speechRate: state.settings.speechRate,\n    bookmarks: state.settings.bookmarks,\n    voiceURI: state.settings.voiceURI,\n    mainVersion: state.tmpSettings.mainVersion,\n  }\n};\n\nconst SettingsPage = withIonLifeCycle(_SettingsPage);\n\nexport default connect(\n  mapStateToProps,\n)(SettingsPage);\n","import React from 'react';\nimport { IonButton, IonContent, IonItem, IonLabel, IonList, IonModal, IonToggle } from '@ionic/react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport Globals from '../Globals';\nimport * as qrcode from 'qrcode';\n\ninterface Props {\n  showModal: boolean;\n  text: string;\n  finish: Function;\n  settings: any;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  tab: string;\n  path: string;\n}> { }\n\ninterface State {\n  isAppSettingsExport: Array<boolean>;\n}\n\nclass _ShareTextModal extends React.Component<PageProps, State> {\n\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      isAppSettingsExport: Array<boolean>(Object.keys(Globals.appSettings).length)\n    }\n  }\n\n  updateQrCode() {\n    const appSettingsExport = Object.keys(Globals.appSettings).filter((key, i) => this.state.isAppSettingsExport[i]).map((key, i) => {return {key: key, val: this.props.settings[key]};});\n    let appSettingsString: string | null = appSettingsExport.map(keyVal => `${keyVal.key}=${+keyVal.val}`).join(',');\n    appSettingsString = appSettingsString !== '' ? `settings=${appSettingsString}` : null;\n    let appUrl = this.props.text;\n    const hasQueryString = /\\?/.test(appUrl);\n    if (appSettingsString) {\n      appUrl += hasQueryString ? `&${appSettingsString}` : `?${appSettingsString}`;\n    }\n    \n    Globals.copyToClipboard(appUrl);\n    const qrcCanvas = document.getElementById('qrcCanvas');\n    qrcode.toCanvas(qrcCanvas, appUrl);\n    return qrcCanvas;\n  }\n\n  render() {\n    return (\n      <IonModal\n        isOpen={this.props.showModal}\n        cssClass='uiFont'\n        swipeToClose={true}\n        //presentingElement={router || undefined}\n        onWillPresent={() => {\n          let isAppSettingsExport: Array<boolean> = [];\n          for (let i = 0; i < this.state.isAppSettingsExport.length; i++) {\n            isAppSettingsExport.push(false);\n          }\n          this.setState({isAppSettingsExport: isAppSettingsExport});\n          this.updateQrCode();\n        }}\n        onDidDismiss={() => this.props.finish()}>\n        <IonContent>\n          <div style={{ display: 'flex', flexDirection: 'column', height: '100%', alignItems: 'center' }}>\n            <div>\n              <IonLabel className='uiFont'>此頁app連結已複製至剪貼簿！</IonLabel>\n            </div>\n            <div>\n              <IonLabel className='uiFont'>也可以使用QR Code分享:</IonLabel>\n            </div>\n            <div style={{ flexGrow: 1, flexShrink: 0, display: 'flex', alignItems: 'center', margin: 10 }}>\n              <canvas id='qrcCanvas' width='500' height='500' style={{ margin: '0px auto' }} />\n            </div>\n            <div>\n              <IonLabel className='uiFont'>包括app設定:</IonLabel>\n              <IonList>\n                {\n                  Object.keys(Globals.appSettings).map((key, i) =>\n                    <IonItem key={`appSettingExportItem_${i}`}>\n                      <IonLabel className='ion-text-wrap uiFont'>{Globals.appSettings[key]}</IonLabel>\n                      <IonToggle slot='end' onIonChange={e => {\n                        const isAppSettingsExport =  this.state.isAppSettingsExport;\n                        isAppSettingsExport[i] = e.detail.checked;\n                        this.setState({isAppSettingsExport: isAppSettingsExport});\n                        this.updateQrCode();\n                      }} />\n                    </IonItem>\n                  )\n                }\n              </IonList>\n            </div>\n            <div>\n              <IonButton fill='outline' shape='round' size='large' onClick={() => this.props.finish()}>關閉</IonButton>\n            </div>\n          </div>\n        </IonContent>\n      </IonModal>\n    );\n  }\n};\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    settings: state.settings,\n  }\n};\n\n//const mapDispatchToProps = {};\n\nexport default connect(\n  mapStateToProps,\n)(_ShareTextModal);\n","import { Bookmark } from \"./Bookmark\";\n\nexport class Settings {\n    version: number = 1;\n    hasAppLog: boolean = true;\n    theme: number = 2;\n    uiFontSize: number = 24;\n    isInitialized: boolean = false;\n    bookmarks: Bookmark[] = [];\n}\n","import Globals from '../../Globals';\nimport { Settings } from '../../models/Settings';\n\nfunction updateUi(newSettings: Settings) {\n  while (document.body.classList.length > 0) {\n    document.body.classList.remove(document.body.classList.item(0)!);\n  }\n  document.body.classList.toggle(`theme${newSettings.theme}`, true);\n  Globals.updateCssVars(newSettings);\n}\n\n// Used to store settings. They will be saved to file.\nexport default function reducer(state = new Settings(), action: any) {\n  var newSettings = { ...state };\n  switch (action.type) {\n    case \"LOAD_SETTINGS\":\n      newSettings = JSON.parse(localStorage.getItem(Globals.storeFile)!).settings;\n      updateUi(newSettings);\n      break;\n    case \"SET_KEY_VAL\":\n      var key = action.key;\n      var val = action.val;\n      switch (key) {\n        case 'theme': {\n          document.body.classList.forEach((val) => {\n            if (/theme/.test(val)) {\n              document.body.classList.remove(val);\n            }\n          });\n          document.body.classList.toggle(`theme${val}`, true);\n          break;\n        }\n      }\n\n      (newSettings as any)[key] = val;\n      localStorage.setItem(Globals.storeFile, JSON.stringify({ settings: newSettings }));\n      break;\n    case \"ADD_BOOKMARK\":\n      newSettings.bookmarks = [...newSettings.bookmarks, action.bookmark];\n      localStorage.setItem(Globals.storeFile, JSON.stringify({ settings: newSettings }));\n      break;\n    case \"DEL_BOOKMARK\": {\n      let bookmarksTemp = newSettings.bookmarks;\n      const idxToDel = bookmarksTemp.findIndex((b) => { return b.uuid === action.uuid });\n      if (idxToDel !== -1) {\n        bookmarksTemp.splice(idxToDel, 1);\n      }\n      newSettings.bookmarks = [...bookmarksTemp];\n      localStorage.setItem(Globals.storeFile, JSON.stringify({ settings: newSettings }));\n      break;\n    }\n    case \"UPDATE_BOOKMARKS\": {\n      newSettings.bookmarks = action.bookmarks;\n      localStorage.setItem(Globals.storeFile, JSON.stringify({ settings: newSettings }));\n      break;\n    }\n    // @ts-ignore\n    case \"DEFAULT_SETTINGS\":\n      newSettings = new Settings();\n      updateUi(newSettings);\n      break;\n    // eslint-disable-next-line\n    default:\n      if (Object.keys(newSettings).length === 0) {\n        newSettings = new Settings();\n      }\n      const defaultSettings = new Settings();\n      Object.keys(defaultSettings).forEach(key => {\n        if ((newSettings as any)[key] === undefined) {\n          (newSettings as any)[key] = (defaultSettings as any)[key];\n        }\n      });\n  }\n  return newSettings;\n}\n","export class TmpSettings {\n    shareTextModal = { text: '', show: false };\n}\n","import { combineReducers } from \"redux\"\n\nimport settings from \"./setReducer\"\nimport tmpSettings from \"./tmpSetReducer\"\n\nexport default combineReducers({\n  settings, tmpSettings\n})\n","import { TmpSettings } from \"../../models/TmpSettings\";\n\n// Used to store temp settings in RAM. They will not be saved to file.\nexport default function reducer(state = new TmpSettings(), action: any) {\n  var newState = { ...state };\n  var key = action.key;\n  var val = action.val;\n  (newState as any)[key] = val;\n  switch (action.type) {\n    case \"TMP_SET_KEY_VAL\": {\n      return newState;\n    }\n    default:\n      break;\n  }\n  return state;\n}\n","import { /*applyMiddleware,*/ createStore, Store } from \"redux\";\n\n//import { logger } from \"redux-logger\"\n//import thunk from \"redux-thunk\"\n//import promise from \"redux-promise-middleware\"\n\nimport reducer from \"./reducers\";\nimport Globals from \"../Globals\";\n\n//const middleware = applyMiddleware(promise(), thunk, logger)\n\nvar savedStore: Store;\n\nexport default function getSavedStore() {\n    var savedSettingsStr = localStorage.getItem(Globals.storeFile);\n    if (savedSettingsStr != null) {\n        savedStore = createStore(reducer, JSON.parse(savedSettingsStr));//, middleware)\n    }\n    else {\n        savedStore = createStore(reducer);//, middleware)\n    }\n\n    return savedStore;\n}\n","export class Bookmark {\n    uuid: string = '';\n    issuer: string = '';\n    account: string = '';\n    secret: string = '';\n\n    constructor(obj: Bookmark) {\n        this.uuid = obj.uuid;\n        this.issuer = obj.issuer;\n        this.account = obj.account;\n        this.secret = obj.secret;\n    }\n}\n","import React from 'react';\nimport { IonAlert, IonButton, IonContent, IonLabel, IonModal } from '@ionic/react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport QrCode from 'qrcode-reader';\nimport Globals from '../Globals';\n\ninterface Props {\n  dispatch: Function;\n  showModal: boolean;\n  finish: Function;\n  settings: any;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  tab: string;\n  path: string;\n}> { }\n\ninterface State {\n  showLoadCameraAlert: boolean;\n}\n\nclass _ScanQrCodeModal extends React.Component<PageProps, State> {\n\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      showLoadCameraAlert: false,\n    }\n  }\n\n  otpauthUriDecode(uri: string) {\n    //uri = 'otpauth://totp/ACME%20Co:john@example.com?secret=HXDMVJECJJWSRB3HWIZR4IFUGFTMXBOZ&issuer=ACME%20Co&algorithm=SHA1&digits=6&period=30';\n    const re0 = /otpauth:\\/\\/totp\\/([^:]*):(.*)\\?.*/i;\n    let [, issuer, account] = re0.exec(uri)!;\n    issuer = decodeURIComponent(issuer);\n    account = decodeURIComponent(account);\n    const re1 = /.*\\?.*secret=([^&]*).*/i;\n    const [, secret] = re1.exec(uri)!;\n    return { issuer, account, secret };\n  }\n\n  stream: MediaStream | undefined;\n  async loadCamera() {\n    this.stream = await Globals.loadCamera();\n    const stream = this.stream!;\n    const videoElement = document.querySelector('#video') as HTMLVideoElement;\n    videoElement.srcObject = stream;\n    const canvas = document.createElement(\"canvas\");\n    const qr = new QrCode();\n\n    const timer = setInterval(() => {\n      canvas.getContext('2d')?.drawImage(videoElement, 0, 0, canvas.width, canvas.height);\n      qr.decode(canvas.toDataURL());\n    }, 500);\n\n    qr.callback = (error: any, result: any) => {\n      if (error || !/otpauth:\\/\\/.*:.*\\?.*secret=.*/i.test(result.result)) {\n        return;\n      }\n\n      clearInterval(timer);\n      videoElement.pause();\n      this.closeStream();\n      this.props.finish(this.otpauthUriDecode(result.result));\n    }\n\n    videoElement.onloadedmetadata = (e) => {\n      videoElement.play();\n      canvas.width = videoElement.videoWidth;\n      canvas.height = videoElement.videoHeight;\n    }\n  }\n\n  closeStream() {\n    this.stream?.getTracks().forEach(t => t.stop());\n  }\n\n  async loadCameraAux() {\n    if (!this.props.settings.isInitialized) {\n      this.setState({ showLoadCameraAlert: true });\n    } else {\n      this.loadCamera();\n    }\n  }\n\n  render() {\n    return (\n      <IonModal\n        isOpen={this.props.showModal}\n        cssClass='uiFont'\n        swipeToClose={true}\n        //presentingElement={router || undefined}\n        onWillPresent={async () => {\n          this.loadCameraAux();\n        }}\n        onDidDismiss={() => {\n          this.closeStream();\n          this.props.finish();\n        }}>\n        <IonContent>\n          <div style={{ display: 'flex', flexDirection: 'column', height: '100%', alignItems: 'center' }}>\n            <div>\n              <IonLabel className='uiFont'>請掃描雙重驗證 QR Code</IonLabel>\n            </div>\n            <div style={{ flexGrow: 1, flexShrink: 0, display: 'flex', alignItems: 'center', margin: 10 }}>\n              <video id='video' width='100%' style={{ margin: '0px auto' }} />\n            </div>\n            <div>\n              <IonButton fill='outline' shape='round' size='large' onClick={() => {\n                this.closeStream();\n                this.props.finish();\n              }}>關閉</IonButton>\n            </div>\n          </div>\n\n          <IonAlert\n            cssClass='uiFont'\n            isOpen={this.state.showLoadCameraAlert}\n            backdropDismiss={false}\n            header={'請在私人裝置使用此 app，避免密碼外流。按下關閉後，會跳出相機授權確認，請允許以掃描 QR code。'}\n            buttons={[\n              {\n                text: '關閉',\n                cssClass: 'primary uiFont',\n                handler: (value) => {\n                  this.setState({\n                    showLoadCameraAlert: false,\n                  });\n                  this.props.dispatch({\n                    type: \"SET_KEY_VAL\",\n                    key: 'isInitialized',\n                    val: true,\n                  });\n                  this.loadCamera();\n                },\n              },\n            ]}\n          />\n        </IonContent>\n      </IonModal>\n    );\n  }\n};\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    settings: state.settings,\n  }\n};\n\n//const mapDispatchToProps = {};\n\nexport default connect(\n  mapStateToProps,\n)(_ScanQrCodeModal);\n","import React from 'react';\nimport { IonContent, IonHeader, IonPage, IonToolbar, withIonLifeCycle, IonList, IonItem, IonLabel, IonToast, IonTitle, IonFab, IonFabButton, IonIcon, IonItemOptions, IonItemOption, IonItemSliding, IonReorderGroup, IonButton, IonReorder } from '@ionic/react';\nimport { ItemReorderEventDetail } from '@ionic/core';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { v4 as uuidv4 } from 'uuid';\nimport authenticator from 'authenticator';\nimport * as d3 from 'd3';\n\nimport { Settings } from '../models/Settings';\nimport { TmpSettings } from '../models/TmpSettings';\nimport './ListPage.css';\nimport { Bookmark } from '../models/Bookmark';\nimport { add, swapVertical } from 'ionicons/icons';\nimport ScanQrCodeModal from '../components/ScanQrCodeModal';\nimport Globals from '../Globals';\n\nconst twoPi = 2 * Math.PI;\n\ninterface Props {\n  dispatch: Function;\n  tmpSettings: TmpSettings;\n  settings: Settings;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  path: string;\n  tab: string;\n}> { }\n\ninterface State {\n  showScanQrCodeModal: boolean;\n  tokens: string[];\n  reorder: boolean;\n  showToast: boolean;\n  toastMessage: string;\n}\n\nclass _ListPage extends React.Component<PageProps, State> {\n  tokenUpdateTimer: NodeJS.Timeout | null;\n  bookmarkListRef: React.RefObject<HTMLIonListElement>;\n\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      showScanQrCodeModal: false,\n      tokens: [],\n      reorder: false,\n      showToast: false,\n      toastMessage: '',\n    }\n\n    this.tokenUpdateTimer = null;\n    this.bookmarkListRef = React.createRef<HTMLIonListElement>();\n  }\n\n  width = 30;\n  height = 30;\n  meter: d3.Selection<SVGPathElement, unknown, HTMLElement, any> | undefined;\n  arc = d3.arc<number>().startAngle(0).endAngle(twoPi).innerRadius(0).outerRadius(this.width / 2);\n\n  createProgressCircles() {    \n    d3.selectAll('.progressCircle').selectChildren().remove();\n    const g = d3.selectAll('.progressCircle')\n      .append('svg')\n      .attr('width', this.width)\n      .attr('height', this.height)\n      .append('g')\n      .attr('transform', `translate(${this.width / 2}, ${this.height / 2})`);\n\n    this.meter = g.append('path')\n      .attr('class', 'progressCircleMeter');\n  }\n\n  ionViewWillEnter() {\n    //console.log(`${this.props.match.url} will enter`);\n\n    this.tokenUpdateTimer = setInterval(() => {\n      const currTime = (new Date().getSeconds() % 30);\n      this.setState({\n        tokens: this.props.settings.bookmarks.map(\n          b => authenticator.generateToken(b.secret).replace(/(.{3})/g, '$1 ')\n        ),\n      });\n      this.meter?.attr('d', this.arc.startAngle(twoPi * currTime / 30)(0));\n    }, 40);\n  }\n\n  ionViewDidEnter() {\n    this.createProgressCircles();\n  }\n\n  ionViewDidLeave() {\n    if (this.tokenUpdateTimer != null) {\n      clearInterval(this.tokenUpdateTimer);\n    }\n  }\n\n  reorderBookmarks(event: CustomEvent<ItemReorderEventDetail>) {\n    const bookmarks = event.detail.complete(this.props.settings.bookmarks);\n    this.props.dispatch({\n      type: \"UPDATE_BOOKMARKS\",\n      bookmarks: bookmarks,\n    });\n  }\n\n  getRows() {\n    let rows = Array<object>();\n    this.props.settings.bookmarks.forEach((item: Bookmark, index: number) => {\n      const token = this.state.tokens[index];\n      rows.push(\n        <IonItemSliding key={`bookmarkItemSliding_` + index}>\n          <IonItem button={true} key={`dictItem` + index}\n            onClick={async event => {\n              event.preventDefault();\n              Globals.copyToClipboard(token.replaceAll(' ', ''));\n              this.setState({ showToast: true, toastMessage: `複製 OTP 成功` })\n            }}>\n            <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n            <div className='listItem'>\n              <div>\n                <IonLabel className='ion-text-wrap uiFont'>\n                  {item.issuer} ({item.account})\n                </IonLabel>\n              </div>\n              <div>\n                <IonLabel color='primary' className='ion-text-wrap uiFontX1_5' key={`bookmarkItemLabel_` + index}>\n                  {token}\n                </IonLabel>\n              </div>\n            </div>\n            <IonLabel className='ion-text-wrap uiFontX1_5 progressCircle' style={{ textAlign: 'right' }} key={`bookmarkItemLabel_` + index}>\n            </IonLabel>\n            <IonReorder slot='end' />\n          </IonItem>\n\n          <IonItemOptions side=\"end\">\n            <IonItemOption className='uiFont' color='danger' onClick={(e) => {\n              this.props.dispatch({\n                type: \"DEL_BOOKMARK\",\n                uuid: item.uuid,\n              });\n              this.bookmarkListRef.current?.closeSlidingItems();\n            }}>刪除</IonItemOption>\n          </IonItemOptions>\n        </IonItemSliding>\n      );\n    });\n    return rows;\n  }\n\n  render() {\n    return (\n      <IonPage>\n        <IonHeader>\n          <IonToolbar>\n            <IonTitle className='uiFont'>驗證碼</IonTitle>\n\n            <IonButton fill={this.state.reorder ? 'solid' : 'clear'} slot='end'\n              onClick={ev => this.setState({ reorder: !this.state.reorder })}>\n              <IonIcon icon={swapVertical} slot='icon-only' />\n            </IonButton>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n\n          {\n            this.props.settings.bookmarks.length === 0 ?\n              <IonLabel className='uiFontX2'>請按右下角加號鈕，掃描雙重驗證 QR code。</IonLabel>\n              :\n              <IonList ref={this.bookmarkListRef}>\n                <IonReorderGroup disabled={!this.state.reorder} onIonItemReorder={(event: CustomEvent<ItemReorderEventDetail>) => { this.reorderBookmarks(event); }}>\n                  {this.getRows()}\n                </IonReorderGroup>\n              </IonList>\n          }\n\n          <IonFab vertical='bottom' horizontal='end' slot='fixed'>\n            <IonFabButton\n              onClick={e => {\n                this.setState({ showScanQrCodeModal: true });\n              }}\n            >\n              <IonIcon icon={add} />\n            </IonFabButton>\n          </IonFab>\n\n          <ScanQrCodeModal\n            {...{\n              showModal: this.state.showScanQrCodeModal,\n              finish: (result: any) => {\n                this.setState({ showScanQrCodeModal: false });\n\n                if (result == null) {\n                  return;\n                }\n                const { issuer, account, secret } = result;\n\n                this.props.dispatch({\n                  type: \"ADD_BOOKMARK\",\n                  bookmark: new Bookmark({\n                    uuid: uuidv4(),\n                    issuer,\n                    account,\n                    secret,\n                  }),\n                });\n                \n                this.createProgressCircles();\n              }, ...this.props\n            }}\n          />\n\n          <IonToast\n            cssClass='uiFont'\n            isOpen={this.state.showToast}\n            onDidDismiss={() => this.setState({ showToast: false })}\n            message={this.state.toastMessage}\n            duration={2000}\n          />\n        </IonContent>\n      </IonPage>\n    );\n  }\n};\n\nconst ListPage = withIonLifeCycle(_ListPage);\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    isLoadingData: state.tmpSettings.isLoadingData,\n    tmpSettings: state.tmpSettings,\n    settings: state.settings,\n  }\n};\n\n//const mapDispatchToProps = {};\n\nexport default connect(\n  mapStateToProps,\n)(ListPage);\n","var map = {\n\t\"./ion-action-sheet.entry.js\": [\n\t\t450,\n\t\t5\n\t],\n\t\"./ion-alert.entry.js\": [\n\t\t451,\n\t\t6\n\t],\n\t\"./ion-app_8.entry.js\": [\n\t\t452,\n\t\t7\n\t],\n\t\"./ion-avatar_3.entry.js\": [\n\t\t453,\n\t\t17\n\t],\n\t\"./ion-back-button.entry.js\": [\n\t\t454,\n\t\t18\n\t],\n\t\"./ion-backdrop.entry.js\": [\n\t\t455,\n\t\t43\n\t],\n\t\"./ion-button_2.entry.js\": [\n\t\t456,\n\t\t19\n\t],\n\t\"./ion-card_5.entry.js\": [\n\t\t457,\n\t\t20\n\t],\n\t\"./ion-checkbox.entry.js\": [\n\t\t458,\n\t\t21\n\t],\n\t\"./ion-chip.entry.js\": [\n\t\t459,\n\t\t22\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t460,\n\t\t44\n\t],\n\t\"./ion-datetime_3.entry.js\": [\n\t\t461,\n\t\t10\n\t],\n\t\"./ion-fab_3.entry.js\": [\n\t\t462,\n\t\t23\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t463,\n\t\t45\n\t],\n\t\"./ion-infinite-scroll_2.entry.js\": [\n\t\t464,\n\t\t46\n\t],\n\t\"./ion-input.entry.js\": [\n\t\t465,\n\t\t24\n\t],\n\t\"./ion-item-option_3.entry.js\": [\n\t\t466,\n\t\t25\n\t],\n\t\"./ion-item_8.entry.js\": [\n\t\t467,\n\t\t26\n\t],\n\t\"./ion-loading.entry.js\": [\n\t\t468,\n\t\t27\n\t],\n\t\"./ion-menu_3.entry.js\": [\n\t\t469,\n\t\t28\n\t],\n\t\"./ion-modal.entry.js\": [\n\t\t470,\n\t\t8\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t471,\n\t\t14\n\t],\n\t\"./ion-popover.entry.js\": [\n\t\t472,\n\t\t9\n\t],\n\t\"./ion-progress-bar.entry.js\": [\n\t\t473,\n\t\t29\n\t],\n\t\"./ion-radio_2.entry.js\": [\n\t\t474,\n\t\t30\n\t],\n\t\"./ion-range.entry.js\": [\n\t\t475,\n\t\t31\n\t],\n\t\"./ion-refresher_2.entry.js\": [\n\t\t476,\n\t\t11\n\t],\n\t\"./ion-reorder_2.entry.js\": [\n\t\t477,\n\t\t16\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t478,\n\t\t47\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t479,\n\t\t32\n\t],\n\t\"./ion-searchbar.entry.js\": [\n\t\t480,\n\t\t33\n\t],\n\t\"./ion-segment_2.entry.js\": [\n\t\t481,\n\t\t34\n\t],\n\t\"./ion-select_3.entry.js\": [\n\t\t482,\n\t\t35\n\t],\n\t\"./ion-slide_2.entry.js\": [\n\t\t483,\n\t\t48\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t484,\n\t\t13\n\t],\n\t\"./ion-split-pane.entry.js\": [\n\t\t485,\n\t\t49\n\t],\n\t\"./ion-tab-bar_2.entry.js\": [\n\t\t486,\n\t\t36\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t487,\n\t\t15\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t488,\n\t\t37\n\t],\n\t\"./ion-textarea.entry.js\": [\n\t\t489,\n\t\t38\n\t],\n\t\"./ion-toast.entry.js\": [\n\t\t490,\n\t\t39\n\t],\n\t\"./ion-toggle.entry.js\": [\n\t\t491,\n\t\t12\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t492,\n\t\t50\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 277;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t493,\n\t\t57\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 279;\nmodule.exports = webpackAsyncContext;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.0/8 are considered localhost for IPv4.\n  window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n            'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      /*\n      if(registration.waiting) {\n        const reg = registration.waiting;\n        reg.postMessage({ type: 'SKIP_WAITING' });\n        alert('Skip waiting.');\n      }*/\n\n      registration.onupdatefound = () => {\n        //alert('onupdatefound.');\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          console.log(`installingWorker stage changed: ${installingWorker.state}`);\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from \"react-router-dom\";\nimport App, {serviceWorkCallbacks} from './App';\nimport Globals from './Globals';\nimport * as serviceWorker from './serviceWorkerRegistration';\n\n// Enable at the very start for logging most messages.\nGlobals.enableAppLog();\n\nReactDOM.render(<BrowserRouter><App /></BrowserRouter>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register({\n    onSuccess: (registration: ServiceWorkerRegistration) => { console.log('Precache app loaded!'); serviceWorkCallbacks.onSuccess(registration); },\n    onUpdate: (registration: ServiceWorkerRegistration) => { console.log('Found app updated!'); serviceWorkCallbacks.onUpdate(registration); },\n});\n","import { isPlatform, IonLabel } from '@ionic/react';\n\nconst pwaUrl = process.env.PUBLIC_URL || '';\nconst bugReportApiUrl = 'https://vh6ud1o56g.execute-api.ap-northeast-1.amazonaws.com/bugReportMailer';\n\nconst TwoFauthDb = 'TwoFauthDb';\nlet log = '';\n\nasync function getFileFromIndexedDB(fileName: string) {\n  const dbOpenReq = indexedDB.open(TwoFauthDb);\n\n  return new Promise(function (ok, fail) {\n    dbOpenReq.onsuccess = async function (ev) {\n      const db = dbOpenReq.result;\n\n      try {\n        const trans = db.transaction([\"store\"], 'readwrite');\n        let req = trans.objectStore('store').get(fileName);\n        req.onsuccess = async function (_ev) {\n          const data = req.result;\n          if (!data) {\n            console.error(`${fileName} loading failed!`);\n            console.error(new Error().stack);\n            return fail();\n          }\n          return ok(data);\n        };\n      } catch (err) {\n        console.error(err);\n      }\n    };\n  });\n}\n\nasync function saveFileToIndexedDB(fileName: string, data: any) {\n  const dbOpenReq = indexedDB.open(TwoFauthDb);\n  return new Promise<void>((ok, fail) => {\n    dbOpenReq.onsuccess = async (ev: Event) => {\n      const db = dbOpenReq.result;\n\n      const transWrite = db.transaction([\"store\"], 'readwrite')\n      const reqWrite = transWrite.objectStore('store').put(data, fileName);\n      reqWrite.onsuccess = (_ev: any) => ok();\n      reqWrite.onerror = (_ev: any) => fail();\n    };\n  });\n}\n\nasync function removeFileFromIndexedDB(fileName: string) {\n  const dbOpenReq = indexedDB.open(TwoFauthDb);\n  return new Promise<void>((ok, fail) => {\n    try {\n      dbOpenReq.onsuccess = (ev: Event) => {\n        const db = dbOpenReq.result;\n\n        const transWrite = db.transaction([\"store\"], 'readwrite')\n        try {\n          const reqWrite = transWrite.objectStore('store').delete(fileName);\n          reqWrite.onsuccess = (_ev: any) => ok();\n          reqWrite.onerror = (_ev: any) => fail();\n        } catch (err) {\n          console.error(err);\n        }\n      };\n    } catch (err) {\n      fail(err);\n    }\n  });\n}\n\nasync function clearIndexedDB() {\n  const dbOpenReq = indexedDB.open(TwoFauthDb);\n  return new Promise<void>((ok, fail) => {\n    dbOpenReq.onsuccess = async (ev: Event) => {\n      const db = dbOpenReq.result;\n\n      const transWrite = db.transaction([\"store\"], 'readwrite')\n      const reqWrite = transWrite.objectStore('store').clear();\n      reqWrite.onsuccess = (_ev: any) => ok();\n      reqWrite.onerror = (_ev: any) => fail();\n    };\n  });\n}\n\nasync function clearAppData() {\n  localStorage.clear();\n  await clearIndexedDB();\n}\n\nasync function getCurrentPosition() {\n  return new Promise<GeolocationPosition>((ok, fail) => {\n    if (!navigator.geolocation) {\n      fail('No geolocation object!');\n    } else {\n      navigator.geolocation.getCurrentPosition((position: GeolocationPosition) => {\n        ok(position);\n      }, (error: GeolocationPositionError) => {\n        fail(`${error.code}: ${error.message}`);\n      });\n    }\n  });\n}\n\nconst webkit = (window as any).webkit;\nfunction isWKWebView() {\n  return webkit?.messageHandlers?.swiftCallbackHandler != null;\n}\n\nlet isRequestingCamera = false;\nlet cameraResultCode = 0;\n(window as any).CameraResultCallback = (code: number) => {\n  cameraResultCode = code;\n  isRequestingCamera = false;\n}\n\nasync function loadCamera() {\n  try {\n    if (isWKWebView()) {\n      await new Promise<void>(async (ok, fail) => {\n        isRequestingCamera = true;\n        webkit.messageHandlers.swiftCallbackHandler.postMessage({\n          event: 'camera'\n        });\n\n        const timer = setInterval(() => {\n          if (!isRequestingCamera) {\n            clearInterval(timer);\n\n            if (cameraResultCode) {\n              fail();\n            } else {\n              ok();\n            }\n          }\n        }, 500);\n      });\n    }\n\n    return await navigator.mediaDevices.getUserMedia({\n      video: { width: 720, height: 1280, facingMode: 'environment' }\n    });\n  } catch (error) {\n    console.error(error);\n    throw(error);\n  }\n}\n\n//const electronBackendApi: any = (window as any).electronBackendApi;\n\nfunction removeElementsByClassName(doc: Document, className: string) {\n  let elements = doc.getElementsByClassName(className);\n  while (elements.length > 0) {\n    elements[0].parentNode?.removeChild(elements[0]);\n  }\n}\n\nconst consoleLog = console.log.bind(console);\nconst consoleError = console.error.bind(console);\n\nfunction getLog() {\n  return log;\n}\n\nfunction enableAppLog() {\n  console.log = function () {\n    log += '----- Info ----\\n';\n    log += (Array.from(arguments)) + '\\n';\n    consoleLog.apply(console, arguments as any);\n  };\n\n  console.error = function () {\n    log += '----- Error ----\\n';\n    log += (Array.from(arguments)) + '\\n';\n    consoleError.apply(console, arguments as any);\n  };\n}\n\nfunction disableAppLog() {\n  log = '';\n  console.log = consoleLog;\n  console.error = consoleError;\n}\n\nfunction disableAndroidChromeCallout(event: any) {\n  event.preventDefault();\n  event.stopPropagation();\n  return false;\n}\n\n// Workable but imperfect.\nfunction disableIosSafariCallout(this: Window, event: any) {\n  const s = this.getSelection();\n  if ((s?.rangeCount || 0) > 0) {\n    const r = s?.getRangeAt(0);\n    s?.removeAllRanges();\n    setTimeout(() => {\n      s?.addRange(r!);\n    }, 50);\n  }\n}\n\nfunction copyToClipboard(text: string) {\n  try {\n    navigator.clipboard && navigator.clipboard.writeText(text);\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nfunction isMacCatalyst() {\n  return isPlatform('ios') && navigator.platform === 'MacIntel';\n}\n\nconst Globals = {\n  pwaUrl,\n  bugReportApiUrl,\n  storeFile: 'TwoFauthSettings.json',\n  getCurrentPosition,\n  loadCamera,\n  getLog,\n  enableAppLog,\n  disableAppLog,\n  TwoFauthDb,\n  appSettings: {\n    'theme': '佈景主題',\n    'uiFontSize': 'UI 字型大小',\n  } as Record<string, string>,\n  fetchErrorContent: (\n    <div className='contentCenter'>\n      <IonLabel>\n        <div>\n          <div>連線失敗!</div>\n          <div style={{ fontSize: 'var(--ui-font-size)', paddingTop: 24 }}>如果問題持續發生，請執行<a href={`/${pwaUrl}/settings`} target=\"_self\">設定頁</a>的 app 異常回報功能。</div>\n        </div>\n      </IonLabel>\n    </div>\n  ),\n  updateApp: () => {\n    return new Promise(async resolve => {\n      navigator.serviceWorker.getRegistrations().then(async regs => {\n        const hasUpdates = await Promise.all(regs.map(reg => (reg.update() as any).then((newReg: ServiceWorkerRegistration) => {\n          return newReg.installing !== null || newReg.waiting !== null;\n        })));\n        resolve(hasUpdates.reduce((prev, curr) => prev || curr, false));\n      });\n    });\n  },\n  updateCssVars: (settings: any) => {\n    document.documentElement.style.cssText = `--ui-font-size: ${settings.uiFontSize}px;`\n  },\n  isMacCatalyst,\n  isTouchDevice: () => {\n    return (isPlatform('ios') && !isMacCatalyst()) || isPlatform('android');\n  },\n  isStoreApps: () => {\n    return isPlatform('pwa') || isPlatform('electron');\n  },\n  isWKWebView,\n  getFileFromIndexedDB,\n  saveFileToIndexedDB,\n  removeFileFromIndexedDB,\n  clearAppData,\n  removeElementsByClassName,\n  disableAndroidChromeCallout,\n  disableIosSafariCallout,\n  copyToClipboard,\n};\n\nexport default Globals;\n","import React from 'react';\nimport { Redirect, Route, RouteComponentProps, withRouter } from 'react-router-dom';\nimport {\n  setupConfig,\n  IonApp,\n  IonIcon,\n  IonRouterOutlet,\n  IonTabBar,\n  IonTabButton,\n  IonTabs,\n  IonAlert,\n  isPlatform,\n  IonToast,\n} from '@ionic/react';\nimport { IonReactRouter } from '@ionic/react-router';\nimport { connect, Provider } from 'react-redux';\nimport queryString from 'query-string';\nimport getSavedStore from './redux/store';\nimport { settings, key } from 'ionicons/icons';\n\n/* Core CSS required for Ionic components to work properly */\nimport '@ionic/react/css/core.css';\n\n/* Basic CSS for apps built with Ionic */\nimport '@ionic/react/css/normalize.css';\nimport '@ionic/react/css/structure.css';\nimport '@ionic/react/css/typography.css';\n\n/* Optional CSS utils that can be commented out */\nimport '@ionic/react/css/padding.css';\nimport '@ionic/react/css/float-elements.css';\nimport '@ionic/react/css/text-alignment.css';\nimport '@ionic/react/css/text-transformation.css';\nimport '@ionic/react/css/flex-utils.css';\nimport '@ionic/react/css/display.css';\n\n/* Theme variables */\nimport './theme/variables.css';\nimport SettingsPage from './pages/SettingsPage';\nimport Globals from './Globals';\nimport ListPage from './pages/ListPage';\nimport ShareTextModal from './components/ShareTextModal';\nimport { Settings } from './models/Settings';\nimport { TmpSettings } from './models/TmpSettings';\n\nconst electronBackendApi: any = (window as any).electronBackendApi;\n\nlet store = getSavedStore();\n/*\nclass DebugRouter extends IonReactRouter {\n  constructor(props: any) {\n    super(props);\n    console.log('initial history is: ', JSON.stringify(this.history, null, 2))\n    this.history.listen((location, action) => {\n      console.log(\n        `The current URL is ${location.pathname}${location.search}${location.hash}`\n      )\n      console.log(`The last navigation action was ${action}`, JSON.stringify(this.history, null, 2));\n    });\n  }\n}\n*/\n\nsetupConfig({\n  mode: 'md', // Use a consistent UI style across Android and iOS.\n  swipeBackEnabled: false,\n});\n\nexport var serviceWorkCallbacks = {\n  onSuccess: function (registration: ServiceWorkerRegistration) { },\n  onUpdate: function (registration: ServiceWorkerRegistration) { },\n};\n\ninterface Props {\n  dispatch: Function;\n  shareTextModal: any;\n  settings: Settings;\n  tmpSettings: TmpSettings;\n}\n\ninterface PageProps extends RouteComponentProps<{\n  tab: string;\n  path: string;\n}> { }\n\ninterface AppOrigProps extends Props, RouteComponentProps<{\n  tab: string;\n  path: string;\n}> { }\n\ninterface State {\n  showToast: boolean;\n  toastMessage: string;\n  showUpdateAlert: boolean;\n  showRestoreAppSettingsToast: boolean;\n}\n\nclass _App extends React.Component<PageProps> {\n  render() {\n    return (\n      <Provider store={store}>\n        <AppOrig {...this.props} />\n      </Provider>\n    );\n  }\n}\n\nclass _AppOrig extends React.Component<AppOrigProps, State> {\n  registrationNew: ServiceWorkerRegistration | null;\n  originalAppSettingsStr: string | null | undefined;\n\n  constructor(props: any) {\n    super(props);\n    if (!this.props.settings.hasAppLog) {\n      Globals.disableAppLog();\n    }\n\n    electronBackendApi?.receive(\"fromMain\", (data: any) => {\n      switch (data.event) {\n        case 'version':\n          store.dispatch({\n            type: \"TMP_SET_KEY_VAL\",\n            key: 'mainVersion',\n            val: data.version,\n          });\n          break;\n      }\n    });\n    electronBackendApi?.send(\"toMain\", { event: 'ready' });\n\n    this.registrationNew = null;\n    // Disable browser callout.\n    if (isPlatform('android')) {\n      window.oncontextmenu = Globals.disableAndroidChromeCallout;\n    } else if (isPlatform('ios')) {\n      document.ontouchend = Globals.disableIosSafariCallout.bind(window);\n    }\n\n    // ----- Initializing UI settings -----\n    // Apply the theme setting.\n    while (document.body.classList.length > 0) {\n      document.body.classList.remove(document.body.classList.item(0)!);\n    }\n    document.body.classList.toggle(`theme${this.props.settings.theme}`, true);\n\n    // Modify UI settings from query string.\n    const queryParams = queryString.parse(this.props.location.search) as any;\n    if (queryParams.settings) {\n      this.originalAppSettingsStr = localStorage.getItem(Globals.storeFile);\n      (queryParams.settings as string).split(',').forEach(setting => {\n        const keyVal = setting.split('=');\n        this.props.dispatch({\n          type: \"SET_KEY_VAL\",\n          key: keyVal[0],\n          val: +keyVal[1],\n        });\n      });\n    }\n    setImmediate(() => {\n      Globals.updateCssVars(this.props.settings);\n    });\n\n    this.state = {\n      showUpdateAlert: false,\n      showRestoreAppSettingsToast: (queryParams.settings != null && this.originalAppSettingsStr != null) || false,\n      showToast: false,\n      toastMessage: '',\n    };\n\n    serviceWorkCallbacks.onUpdate = (registration: ServiceWorkerRegistration) => {\n      this.registrationNew = registration;\n      this.setState({ showUpdateAlert: true });\n    };\n\n    serviceWorkCallbacks.onSuccess = (registration: ServiceWorkerRegistration) => {\n    };\n\n    // Preload speechSynthesis.\n    if (typeof speechSynthesis !== 'undefined') {\n      speechSynthesis.getVoices();\n      speechSynthesis.cancel();\n    }\n\n    // Enable screen wake lock.\n    if ((navigator as any).wakeLock) {\n      this.wakeLockScreen();\n      document.addEventListener(\"visibilitychange\", async () => {\n        if (document.visibilityState === 'visible') {\n          this.wakeLockScreen();\n        } else {\n          this.wakeLockScreenRelease()\n        }\n      });\n    }\n\n    const dbOpenReq = indexedDB.open(Globals.TwoFauthDb);\n    // Init store in indexedDB if necessary.\n    dbOpenReq.onupgradeneeded = function (event: IDBVersionChangeEvent) {\n      var db = (event.target as any).result;\n      db.createObjectStore('store');\n      console.log(`DB store created.`);\n    };\n  }\n\n  restoreAppSettings() {\n    localStorage.setItem(Globals.storeFile, this.originalAppSettingsStr!);\n    this.props.dispatch({ type: 'LOAD_SETTINGS' });\n  }\n\n  // Prevent device from sleeping.\n  wakeLock: any;\n  async wakeLockScreen() {\n    try {\n      const wakeLock = (navigator as any).wakeLock;\n      if (wakeLock != null) {\n        this.wakeLock = await wakeLock.request('screen');\n        console.log('Screen wake lock is requested.');\n      } else {\n        console.error('navigator.wakeLock is undefined.');\n      }\n    } catch (err: any) {\n      // the wake lock request fails - usually system related, such low as battery\n      console.log(`${err.name}, ${err.message}`);\n      console.log(new Error().stack);\n    }\n  }\n\n  async wakeLockScreenRelease() {\n    if (this.wakeLock != null) {\n      await this.wakeLock.release();\n      this.wakeLock = null;\n      console.log('Screen wake lock is released.');\n    }\n  }\n\n  routeByQueryString() {\n    // This app uses client side routing. \n    // Without the first loading of this app,\n    // any client side route becomes a server side route!\n    // These invalid server side routings cause 404 errors.\n    // To workaround these errors, we can use GitHub 404.html redirection\n    // to pass the client side routes to this app by using query string.\n    // After this app loads, it can use the query string to correctly redirect to\n    // a client side route!\n    console.log(window.location.search);\n    const routeMatches = /route=([^&]*)/.exec(window.location.search);\n    const queryMatches = /query=([^&]*)/.exec(window.location.search);\n    if (routeMatches !== null) {\n      const route = decodeURIComponent(routeMatches[1]);\n\n      let query = ''\n      if (queryMatches !== null) {\n        query = decodeURIComponent(queryMatches[1]);\n      }\n      return <Redirect to={`${Globals.pwaUrl}` + route + query} />;\n    } else if (window.location.pathname === `${Globals.pwaUrl}/` || window.location.pathname === `${Globals.pwaUrl}`) {\n      return <Redirect to={`${Globals.pwaUrl}/list`} />;\n    }\n  }\n\n  render() {\n    return (\n      <IonApp>\n        <IonReactRouter>\n          <IonTabs>\n            <IonRouterOutlet animated={false}>\n              {/* The following route is for backward compatibility. */}\n              <Route path={`${Globals.pwaUrl}/list`} render={(props: any) => <ListPage {...props} />} exact={true} />\n              <Route path={`${Globals.pwaUrl}/settings`} render={(props: any) => <SettingsPage {...props} />} />\n              <Route path={`${Globals.pwaUrl}/`} render={() => { return this.routeByQueryString(); }} exact={true} />\n            </IonRouterOutlet>\n            <IonTabBar slot=\"bottom\">\n              <IonTabButton tab=\"list\" href={`${Globals.pwaUrl}/list`}>\n                <IonIcon icon={key} />\n              </IonTabButton>\n              <IonTabButton tab=\"settings\" href={`${Globals.pwaUrl}/settings`}>\n                <IonIcon icon={settings} />\n              </IonTabButton>\n            </IonTabBar>\n          </IonTabs>\n        </IonReactRouter>\n        <IonAlert\n          cssClass='uiFont'\n          isOpen={this.state.showUpdateAlert}\n          backdropDismiss={false}\n          onDidPresent={(ev) => {\n            // Run SKIP_WAITING at onDidPresent event to avoid a race condition of\n            // an old page fetching old JS chunks with a new service worker!\n            this.registrationNew?.installing?.postMessage({ type: 'SKIP_WAITING' });\n            this.registrationNew?.waiting?.postMessage({ type: 'SKIP_WAITING' });\n          }}\n          header={'App 已更新，請重啟!'}\n          buttons={[\n            {\n              text: '關閉',\n              cssClass: 'primary uiFont',\n              handler: (value) => {\n                this.setState({\n                  showUpdateAlert: false,\n                });\n              },\n            }\n          ]}\n        />\n\n        <ShareTextModal\n          {...{\n            text: this.props.shareTextModal?.text,\n            showModal: this.props.shareTextModal?.show || false,\n            finish: () => {\n              store.dispatch({\n                type: \"TMP_SET_KEY_VAL\",\n                key: 'shareTextModal',\n                val: { show: false },\n              });\n            }, ...this.props\n          }}\n        />\n\n        <IonToast\n          cssClass='uiFont'\n          isOpen={this.state.showRestoreAppSettingsToast}\n          onDidDismiss={() => this.setState({ showRestoreAppSettingsToast: false })}\n          message={`已套用app連結中的設定，是否還原設定？`}\n          buttons={[\n            {\n              text: '取消',\n              role: 'cancel',\n              handler: () => this.setState({ showRestoreAppSettingsToast: false })\n            },\n            {\n              text: '還原',\n              handler: () => this.restoreAppSettings(),\n            },\n          ]}\n        />\n\n        <IonToast\n          cssClass='uiFont'\n          isOpen={this.state.showToast}\n          onDidDismiss={() => this.setState({ showToast: false })}\n          message={this.state.toastMessage}\n          duration={2000}\n        />\n      </IonApp>\n    );\n  }\n}\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    shareTextModal: state.tmpSettings.shareTextModal,\n    settings: state.settings,\n    tmpSettings: state.tmpSettings,\n  }\n};\n\nconst AppOrig = connect(\n  mapStateToProps,\n)(_AppOrig);\n\n\nconst App = withRouter(_App);\n\nexport default App;\n"],"sourceRoot":""}