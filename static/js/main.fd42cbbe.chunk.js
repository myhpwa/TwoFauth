(this.webpackJsonpTwoFauth=this.webpackJsonpTwoFauth||[]).push([[1],{120:function(e){e.exports=JSON.parse('{"name":"TwoFauth","homepage":"/TwoFauth","productName":"\u96d9\u91cd\u9a57\u8b49","pwaVersion":"1.3.2","version":"1.1.0","license":"MIT","keywords":["Two Factor Authenticator","2FA","Progressive Web App","PWA"],"description":"A two factor authenticator PWA","repository":"https://github.com/MrMYHuang/TwoFauth","author":{"name":"Meng-Yuan Huang","email":"myh@live.com"},"private":false,"files":["README.md"],"main":"buildElectron/main.js","scripts":{"postinstall":"electron-builder install-app-deps","start":"react-app-rewired start","build":"react-app-rewired build && powershell -file CopyBuild.ps1","build_linux":"react-app-rewired build && ./CopyBuild.sh","test":"react-app-rewired test","eject":"react-scripts eject","build-electron":"tsc -b tsconfigElectron.json","build-electron-store":"tsc -b tsconfigElectron.json && mv buildElectron/mainStore.js buildElectron/main.js","start-electron":"npm run build-electron && electron .","dist-snap":"npm run build-electron-store && rm -f dist/*.snap && electron-builder -l snap -c electronBuilderConfigs/snap.json -c.extraMetadata.name=two-fauth","dist-snap-arm64":"export SNAPCRAFT_BUILD_ENVIRONMENT=lxd && npm run build-electron-store && rm -f dist/*.snap && electron-builder -l snap -c electronBuilderConfigs/snap.json -c.extraMetadata.name=two-fauth","publish-snap":"snapcraft upload --release=stable dist/*.snap","icons-mas":"cd buildElectron && iconutil -c icns icon.iconset","dist-mas":"npm run build-electron-store && electron-builder -m mas --universal -c electronBuilderConfigs/mas.json","dist-mas-dev":"npm run build-electron-store && electron-builder -m mas-dev --arm64 -c electronBuilderConfigs/masDev.json"},"dependencies":{"electron-window-state":"^5.0.3"},"devDependencies":{"@ionic/react":"^5.6.12","@ionic/react-router":"^5.6.12","@testing-library/jest-dom":"^5.14.1","@testing-library/react":"^11.2.7","@testing-library/user-event":"^12.8.3","@types/authenticator":"^1.1.0","@types/d3":"^7.0.0","@types/jest":"^26.0.24","@types/node":"^12.20.16","@types/qrcode":"^1.4.1","@types/react":"^16.14.11","@types/react-dom":"^16.9.14","@types/react-redux":"^7.1.18","@types/react-router":"^5.1.16","@types/react-router-dom":"^5.1.8","@types/uuid":"^8.3.1","authenticator":"^1.1.5","axios":"^0.21.1","customize-cra":"^1.0.0","d3":"^7.0.0","electron":"^11.4.10","electron-builder":"^22.11.7","electron-builder-notarize-pkg":"^1.2.0","history":"^4.10.1","ionicons":"^5.5.2","memfs":"^3.2.0","node-downloader-helper":"^1.0.18","qrcode":"^1.4.4","qrcode-reader":"^1.0.4","query-string":"^6.14.1","react":"^17.0.2","react-app-rewired":"^2.1.7","react-dom":"^17.0.2","react-redux":"^7.2.4","react-router":"^5.2.0","react-router-dom":"^5.2.0","react-scripts":"^4.0.3","react-test-renderer":"16.2.0","redux":"^4.1.0","typescript":"^4.3.5","uuid":"^8.3.1","workbox-background-sync":"^5.1.3","workbox-broadcast-update":"^5.1.3","workbox-cacheable-response":"^5.1.3","workbox-core":"^5.1.3","workbox-expiration":"^5.1.3","workbox-google-analytics":"^5.1.3","workbox-navigation-preload":"^5.1.3","workbox-precaching":"^5.1.3","workbox-range-requests":"^5.1.3","workbox-routing":"^5.1.3","workbox-strategies":"^5.1.3","workbox-streams":"^5.1.3"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},203:function(e,t,n){"use strict";(function(e){var r=n(4),s=n.n(r),o=n(8),a=n(7),i=n(10),c=n(12),l=n(13),u=n(0),p=n.n(u),d=n(2),h=n(35),f=n(204),j=n.n(f),b=n(5),m=n(18),v=(n(326),n(120)),g=n(1),x=function(t){Object(c.a)(r,t);var n=Object(l.a)(r);function r(e){var t;return Object(a.a)(this,r),(t=n.call(this,e)).reportText="",t.state={showBugReportAlert:!1,showClearAlert:!1,showToast:!1,toastMessage:""},t}return Object(i.a)(r,[{key:"ionViewWillEnter",value:function(){}},{key:"render",value:function(){var t=this;return Object(g.jsxs)(d.p,{children:[Object(g.jsx)(d.g,{children:Object(g.jsx)(d.D,{children:Object(g.jsx)(d.A,{className:"uiFont",children:"\u8a2d\u5b9a"})})}),Object(g.jsxs)(d.d,{children:[Object(g.jsxs)(d.n,{children:[Object(g.jsxs)(d.i,{children:[Object(g.jsx)("div",{tabIndex:0}),Object(g.jsx)(d.h,{icon:m.c,slot:"start"}),Object(g.jsx)(d.m,{className:"ion-text-wrap uiFont",children:"\u555f\u7528 app \u7570\u5e38\u8a18\u9304"}),Object(g.jsx)(d.C,{slot:"end",checked:this.props.hasAppLog,onIonChange:function(e){var n=e.detail.checked;t.props.hasAppLog!==n&&(n?b.a.enableAppLog():b.a.disableAppLog(),t.props.dispatch({type:"SET_KEY_VAL",key:"hasAppLog",val:n}))}})]}),Object(g.jsxs)(d.i,{hidden:!this.props.settings.hasAppLog,children:[Object(g.jsx)("div",{tabIndex:0}),Object(g.jsx)(d.h,{icon:m.c,slot:"start"}),Object(g.jsx)(d.m,{className:"ion-text-wrap uiFont",children:"\u56de\u5831 app \u7570\u5e38\u8a18\u9304"}),Object(g.jsx)(d.c,{fill:"outline",shape:"round",slot:"end",size:"large",className:"uiFont",onClick:function(e){t.reportText="\u700f\u89bd\u5668\uff1a"+navigator.userAgent+"\n\nApp\u7248\u672c\uff1a"+v.pwaVersion+"\n\nApp\u8a2d\u5b9a\uff1a"+JSON.stringify(t.props.settings)+"\n\nLog\uff1a\n"+b.a.getLog(),t.setState({showBugReportAlert:!0})},children:"\u56de\u5831"}),Object(g.jsx)(d.a,{cssClass:"uiFont",backdropDismiss:!1,isOpen:this.state.showBugReportAlert,header:"\u7570\u5e38\u56de\u5831",subHeader:"\u8f38\u5165\u60a8\u7684 E-mail\uff0c\u4ee5\u5f8c\u7e8c\u806f\u7d61",inputs:[{name:"name0",type:"email",placeholder:"\u4f8b\uff1aabc@example.com"},{name:"name1",type:"textarea",placeholder:"\u8acb\u63cf\u8ff0\u767c\u751f\u6b65\u9a5f"}],buttons:[{text:"\u9001\u51fa",cssClass:"primary uiFont",handler:function(){var e=Object(o.a)(s.a.mark((function e(n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(n.name0)){e.next=3;break}return t.setState({showBugReportAlert:!1,showToast:!0,toastMessage:"\u932f\u8aa4\uff0cE-mail \u4e0d\u7b26\u683c\u5f0f\uff01"}),e.abrupt("return");case 3:return e.prev=3,r=j.a.create({timeout:1e4}),e.next=7,r.post(b.a.bugReportApiUrl,{subject:"".concat(v.productName,"\u7570\u5e38\u8a18\u9304\u56de\u5831"),text:"E-mail: ".concat(n.name0,"\n\n\u767c\u751f\u6b65\u9a5f: ").concat(n.name1,"\n\n").concat(t.reportText)});case 7:t.setState({showBugReportAlert:!1,showToast:!0,toastMessage:"\u7570\u5e38\u56de\u5831\u6210\u529f"}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.error(e.t0),t.setState({showBugReportAlert:!1,showToast:!0,toastMessage:"\u7570\u5e38\u56de\u5831\u5931\u6557"});case 14:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()},{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary uiFont",handler:function(){return t.setState({showBugReportAlert:!1})}}]})]}),Object(g.jsxs)(d.i,{children:[Object(g.jsx)("div",{tabIndex:0}),Object(g.jsx)(d.h,{icon:m.k,slot:"start"}),Object(g.jsx)("div",{className:"contentBlock",children:Object(g.jsxs)("div",{style:{flexDirection:"column"},children:[Object(g.jsx)(d.m,{className:"ion-text-wrap uiFont",children:"App \u8a2d\u5b9a"}),Object(g.jsxs)("div",{style:{textAlign:"right"},children:[Object(g.jsx)(d.c,{fill:"outline",shape:"round",size:"large",className:"uiFont",onClick:function(){var e=Object(o.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="data:text/json;charset=utf-8,".concat(encodeURIComponent(localStorage.getItem(b.a.storeFile)||"")),(r=document.createElement("a")).href=n,r.download=b.a.storeFile,r.click(),r.remove();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:"\u532f\u51fa"}),Object(g.jsx)("input",{id:"importJsonInput",type:"file",accept:".json",style:{display:"none"},onChange:function(){var e=Object(o.a)(s.a.mark((function e(n){var r,o,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=null===(r=n.target.files)||void 0===r?void 0:r.item(0),e.next=3,null===o||void 0===o?void 0:o.text();case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0="";case 6:a=e.t0;try{JSON.parse(a),localStorage.setItem(b.a.storeFile,a),t.props.dispatch({type:"LOAD_SETTINGS"})}catch(s){console.error(s),console.error((new Error).stack)}document.getElementById("importJsonInput").value="";case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),Object(g.jsx)(d.c,{fill:"outline",shape:"round",size:"large",className:"uiFont",onClick:function(e){document.querySelector("#importJsonInput").click()},children:"\u532f\u5165"}),Object(g.jsx)(d.c,{fill:"outline",shape:"round",size:"large",className:"uiFont",onClick:function(e){t.setState({showClearAlert:!0})},children:"\u91cd\u7f6e"}),Object(g.jsx)(d.a,{cssClass:"uiFont",isOpen:this.state.showClearAlert,backdropDismiss:!1,onDidPresent:function(e){},header:"\u91cd\u7f6e\u6703\u9084\u539fapp\u8a2d\u5b9a\u9810\u8a2d\u503c\u4e26\u6e05\u9664\u66f8\u7c64\u3001\u96e2\u7dda\u8cc7\u6599\u6a94\uff01\u78ba\u5b9a\u91cd\u7f6e\uff1f",buttons:[{text:"\u53d6\u6d88",cssClass:"primary uiFont",handler:function(e){t.setState({showClearAlert:!1})}},{text:"\u91cd\u7f6e",cssClass:"secondary uiFont",handler:function(){var e=Object(o.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.clearAppData();case 2:t.props.dispatch({type:"DEFAULT_SETTINGS"}),t.setState({showClearAlert:!1,showToast:!0,toastMessage:"\u6e05\u9664\u6210\u529f!"});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]})]})]})})]}),Object(g.jsxs)(d.i,{children:[Object(g.jsx)("div",{tabIndex:0}),Object(g.jsx)(d.h,{icon:m.j,slot:"start"}),Object(g.jsx)(d.m,{className:"ion-text-wrap uiFont",children:b.a.appSettings.theme}),Object(g.jsxs)(d.v,{slot:"end",value:+this.props.theme,className:"uiFont",interface:"popover",interfaceOptions:{cssClass:"TwoFauththemes"},onIonChange:function(e){var n=+e.detail.value;+t.props.theme!==n&&t.props.dispatch({type:"SET_KEY_VAL",key:"theme",val:n})},children:[Object(g.jsx)(d.w,{className:"uiFont cbeta",value:0,children:"\u7da0\u5e95"}),Object(g.jsx)(d.w,{className:"uiFont dark",value:1,children:"\u6697\u8272"}),Object(g.jsx)(d.w,{className:"uiFont light",value:2,children:"\u4eae\u8272"}),Object(g.jsx)(d.w,{className:"uiFont oldPaper",value:3,children:"\u820a\u66f8"}),Object(g.jsx)(d.w,{className:"uiFont marble",value:4,children:"\u5927\u7406\u77f3"})]})]}),Object(g.jsxs)(d.i,{children:[Object(g.jsx)("div",{tabIndex:0}),Object(g.jsx)(d.h,{icon:m.v,slot:"start"}),Object(g.jsx)("div",{className:"contentBlock",children:Object(g.jsxs)("div",{style:{flexDirection:"column"},children:[Object(g.jsxs)(d.m,{className:"ion-text-wrap uiFont",children:[b.a.appSettings.uiFontSize,": ",this.props.uiFontSize]}),Object(g.jsx)(d.q,{min:12,max:32,pin:!0,snaps:!0,value:this.props.uiFontSize,onIonChange:function(n){t.props.dispatch({type:"SET_KEY_VAL",key:"uiFontSize",val:+n.detail.value}),e((function(){b.a.updateCssVars(t.props.settings)}))}})]})})]}),Object(g.jsxs)(d.i,{children:[Object(g.jsx)("div",{tabIndex:0}),Object(g.jsx)(d.h,{icon:m.l,slot:"start"}),Object(g.jsxs)("div",{className:"uiFont",children:[Object(g.jsx)("div",{children:"\u95dc\u65bc"}),Object(g.jsx)("div",{children:"\u4f5c\u8005: Meng-Yuan Huang"}),Object(g.jsx)("div",{children:Object(g.jsx)("a",{href:"mailto:myh@live.com",target:"_new",children:"myh@live.com"})})]})]})]}),Object(g.jsx)(d.B,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return t.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})]})}}]),r}(p.a.Component),w=Object(d.O)(x);t.a=Object(h.b)((function(e){return{settings:e.settings,hasAppLog:e.settings.hasAppLog,theme:e.settings.theme,uiFontSize:e.settings.uiFontSize,speechRate:e.settings.speechRate,bookmarks:e.settings.bookmarks,voiceURI:e.settings.voiceURI,mainVersion:e.tmpSettings.mainVersion}}))(w)}).call(this,n(89).setImmediate)},206:function(e,t,n){"use strict";var r=n(7),s=n(10),o=n(12),a=n(13),i=n(0),c=n.n(i),l=n(2),u=n(35),p=n(5),d=n(207),h=n(1),f=function(e){Object(o.a)(n,e);var t=Object(a.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).state={isAppSettingsExport:Array(Object.keys(p.a.appSettings).length)},s}return Object(s.a)(n,[{key:"updateQrCode",value:function(){var e=this,t=Object.keys(p.a.appSettings).filter((function(t,n){return e.state.isAppSettingsExport[n]})).map((function(t,n){return{key:t,val:e.props.settings[t]}})).map((function(e){return"".concat(e.key,"=").concat(+e.val)})).join(",");t=""!==t?"settings=".concat(t):null;var n=this.props.text,r=/\?/.test(n);t&&(n+=r?"&".concat(t):"?".concat(t)),p.a.copyToClipboard(n);var s=document.getElementById("qrcCanvas");return d.toCanvas(s,n),s}},{key:"render",value:function(){var e=this;return Object(h.jsx)(l.o,{isOpen:this.props.showModal,cssClass:"uiFont",swipeToClose:!0,onWillPresent:function(){for(var t=[],n=0;n<e.state.isAppSettingsExport.length;n++)t.push(!1);e.setState({isAppSettingsExport:t}),e.updateQrCode()},onDidDismiss:function(){return e.props.finish()},children:Object(h.jsx)(l.d,{children:Object(h.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%",alignItems:"center"},children:[Object(h.jsx)("div",{children:Object(h.jsx)(l.m,{className:"uiFont",children:"\u6b64\u9801app\u9023\u7d50\u5df2\u8907\u88fd\u81f3\u526a\u8cbc\u7c3f\uff01"})}),Object(h.jsx)("div",{children:Object(h.jsx)(l.m,{className:"uiFont",children:"\u4e5f\u53ef\u4ee5\u4f7f\u7528QR Code\u5206\u4eab:"})}),Object(h.jsx)("div",{style:{flexGrow:1,flexShrink:0,display:"flex",alignItems:"center",margin:10},children:Object(h.jsx)("canvas",{id:"qrcCanvas",width:"500",height:"500",style:{margin:"0px auto"}})}),Object(h.jsxs)("div",{children:[Object(h.jsx)(l.m,{className:"uiFont",children:"\u5305\u62ecapp\u8a2d\u5b9a:"}),Object(h.jsx)(l.n,{children:Object.keys(p.a.appSettings).map((function(t,n){return Object(h.jsxs)(l.i,{children:[Object(h.jsx)(l.m,{className:"ion-text-wrap uiFont",children:p.a.appSettings[t]}),Object(h.jsx)(l.C,{slot:"end",onIonChange:function(t){var r=e.state.isAppSettingsExport;r[n]=t.detail.checked,e.setState({isAppSettingsExport:r}),e.updateQrCode()}})]},"appSettingExportItem_".concat(n))}))})]}),Object(h.jsx)("div",{children:Object(h.jsx)(l.c,{fill:"outline",shape:"round",size:"large",onClick:function(){return e.props.finish()},children:"\u95dc\u9589"})})]})})})}}]),n}(c.a.Component);t.a=Object(u.b)((function(e){return{settings:e.settings}}))(f)},209:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(70),s=n(69),o=n(29),a=n(5),i=n(7),c=function e(){Object(i.a)(this,e),this.version=1,this.hasAppLog=!0,this.theme=2,this.uiFontSize=24,this.isInitialized=!1,this.bookmarks=[]};function l(e){for(;document.body.classList.length>0;)document.body.classList.remove(document.body.classList.item(0));document.body.classList.toggle("theme".concat(e.theme),!0),a.a.updateCssVars(e)}var u=function e(){Object(i.a)(this,e),this.shareTextModal={text:"",show:!1}};var p=Object(r.a)({settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c,t=arguments.length>1?arguments[1]:void 0,n=Object(o.a)({},e);switch(t.type){case"LOAD_SETTINGS":l(n=JSON.parse(localStorage.getItem(a.a.storeFile)).settings);break;case"SET_KEY_VAL":var r=t.key,i=t.val;switch(r){case"theme":document.body.classList.forEach((function(e){/theme/.test(e)&&document.body.classList.remove(e)})),document.body.classList.toggle("theme".concat(i),!0)}n[r]=i,localStorage.setItem(a.a.storeFile,JSON.stringify({settings:n}));break;case"ADD_BOOKMARK":n.bookmarks=[].concat(Object(s.a)(n.bookmarks),[t.bookmark]),localStorage.setItem(a.a.storeFile,JSON.stringify({settings:n}));break;case"DEL_BOOKMARK":var u=n.bookmarks,p=u.findIndex((function(e){return e.uuid===t.uuid}));-1!==p&&u.splice(p,1),n.bookmarks=Object(s.a)(u),localStorage.setItem(a.a.storeFile,JSON.stringify({settings:n}));break;case"UPDATE_BOOKMARKS":n.bookmarks=t.bookmarks,localStorage.setItem(a.a.storeFile,JSON.stringify({settings:n}));break;case"DEFAULT_SETTINGS":l(n=new c);break;default:0===Object.keys(n).length&&(n=new c);var d=new c;Object.keys(d).forEach((function(e){void 0===n[e]&&(n[e]=d[e])}))}return n},tmpSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new u,t=arguments.length>1?arguments[1]:void 0,n=Object(o.a)({},e),r=t.key,s=t.val;switch(n[r]=s,t.type){case"TMP_SET_KEY_VAL":return n}return e}});function d(){var e=localStorage.getItem(a.a.storeFile);return null!=e?Object(r.b)(p,JSON.parse(e)):Object(r.b)(p)}},211:function(e,t,n){"use strict";var r=n(29),s=n(4),o=n.n(s),a=n(8),i=n(7),c=n(10),l=n(12),u=n(13),p=n(0),d=n.n(p),h=n(2),f=n(35),j=n(496),b=n(205),m=n.n(b),v=n(82),g=(n(427),function e(t){Object(i.a)(this,e),this.uuid="",this.issuer="",this.account="",this.secret="",this.uuid=t.uuid,this.issuer=t.issuer,this.account=t.account,this.secret=t.secret}),x=n(18),w=n(47),O=n(208),y=n(5),k=n(1),S=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).stream=void 0,r.state={showLoadCameraAlert:!1},r}return Object(c.a)(n,[{key:"otpauthUriDecode",value:function(e){var t=/otpauth:\/\/totp\/([^:]*):(.*)\?.*/i.exec(e),n=Object(w.a)(t,3),r=n[1],s=n[2];r=decodeURIComponent(r),s=decodeURIComponent(s);var o=/.*\?.*secret=([^&]*).*/i.exec(e);return{issuer:r,account:s,secret:Object(w.a)(o,2)[1]}}},{key:"loadCamera",value:function(){var e=Object(a.a)(o.a.mark((function e(){var t,n,r,s,a,i=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.loadCamera();case 2:this.stream=e.sent,t=this.stream,(n=document.querySelector("#video")).srcObject=t,r=document.createElement("canvas"),s=new O.a,a=setInterval((function(){var e;null===(e=r.getContext("2d"))||void 0===e||e.drawImage(n,0,0,r.width,r.height),s.decode(r.toDataURL())}),500),s.callback=function(e,t){!e&&/otpauth:\/\/.*:.*\?.*secret=.*/i.test(t.result)&&(clearInterval(a),n.pause(),i.closeStream(),i.props.finish(i.otpauthUriDecode(t.result)))},n.onloadedmetadata=function(e){n.play(),r.width=n.videoWidth,r.height=n.videoHeight};case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"closeStream",value:function(){var e;null===(e=this.stream)||void 0===e||e.getTracks().forEach((function(e){return e.stop()}))}},{key:"loadCameraAux",value:function(){var e=Object(a.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.props.settings.isInitialized?this.loadCamera():this.setState({showLoadCameraAlert:!0});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(k.jsx)(h.o,{isOpen:this.props.showModal,cssClass:"uiFont",swipeToClose:!0,onWillPresent:Object(a.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.loadCameraAux();case 1:case"end":return t.stop()}}),t)}))),onDidDismiss:function(){e.closeStream(),e.props.finish()},children:Object(k.jsxs)(h.d,{children:[Object(k.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%",alignItems:"center"},children:[Object(k.jsx)("div",{children:Object(k.jsx)(h.m,{className:"uiFont",children:"\u8acb\u6383\u63cf\u96d9\u91cd\u9a57\u8b49 QR Code"})}),Object(k.jsx)("div",{style:{flexGrow:1,flexShrink:0,display:"flex",alignItems:"center",margin:10},children:Object(k.jsx)("video",{id:"video",width:"100%",style:{margin:"0px auto"}})}),Object(k.jsx)("div",{children:Object(k.jsx)(h.c,{fill:"outline",shape:"round",size:"large",onClick:function(){e.closeStream(),e.props.finish()},children:"\u95dc\u9589"})})]}),Object(k.jsx)(h.a,{cssClass:"uiFont",isOpen:this.state.showLoadCameraAlert,backdropDismiss:!1,header:"\u8acb\u5728\u79c1\u4eba\u88dd\u7f6e\u4f7f\u7528\u6b64 app\uff0c\u907f\u514d\u5bc6\u78bc\u5916\u6d41\u3002\u6309\u4e0b\u95dc\u9589\u5f8c\uff0c\u6703\u8df3\u51fa\u76f8\u6a5f\u6388\u6b0a\u78ba\u8a8d\uff0c\u8acb\u5141\u8a31\u4ee5\u6383\u63cf QR code\u3002",buttons:[{text:"\u95dc\u9589",cssClass:"primary uiFont",handler:function(t){e.setState({showLoadCameraAlert:!1}),e.props.dispatch({type:"SET_KEY_VAL",key:"isInitialized",val:!0}),e.loadCamera()}}]})]})})}}]),n}(d.a.Component),C=Object(f.b)((function(e){return{settings:e.settings}}))(S),A=2*Math.PI,T=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).tokenUpdateTimer=void 0,r.bookmarkListRef=void 0,r.width=30,r.height=30,r.meter=void 0,r.arc=v.a().startAngle(0).endAngle(A).innerRadius(0).outerRadius(r.width/2),r.state={showScanQrCodeModal:!1,tokens:[],reorder:!1,showToast:!1,toastMessage:""},r.tokenUpdateTimer=null,r.bookmarkListRef=d.a.createRef(),r}return Object(c.a)(n,[{key:"createProgressCircles",value:function(){v.b(".progressCircle").selectChildren().remove();var e=v.b(".progressCircle").append("svg").attr("width",this.width).attr("height",this.height).append("g").attr("transform","translate(".concat(this.width/2,", ").concat(this.height/2,")"));this.meter=e.append("path").attr("class","progressCircleMeter")}},{key:"ionViewWillEnter",value:function(){var e=this;this.tokenUpdateTimer=setInterval((function(){var t,n=(new Date).getSeconds()%30;e.setState({tokens:e.props.settings.bookmarks.map((function(e){return m.a.generateToken(e.secret).replace(/(.{3})/g,"$1 ")}))}),null===(t=e.meter)||void 0===t||t.attr("d",e.arc.startAngle(A*n/30)(0))}),40)}},{key:"ionViewDidEnter",value:function(){this.createProgressCircles()}},{key:"ionViewDidLeave",value:function(){null!=this.tokenUpdateTimer&&clearInterval(this.tokenUpdateTimer)}},{key:"reorderBookmarks",value:function(e){var t=e.detail.complete(this.props.settings.bookmarks);this.props.dispatch({type:"UPDATE_BOOKMARKS",bookmarks:t})}},{key:"getRows",value:function(){var e=this,t=Array();return this.props.settings.bookmarks.forEach((function(n,r){var s=e.state.tokens[r];t.push(Object(k.jsxs)(h.l,{children:[Object(k.jsxs)(h.i,{button:!0,onClick:function(){var t=Object(a.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),y.a.copyToClipboard(s.replaceAll(" ","")),e.setState({showToast:!0,toastMessage:"\u8907\u88fd OTP \u6210\u529f"});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),children:[Object(k.jsx)("div",{tabIndex:0}),Object(k.jsxs)("div",{className:"listItem",children:[Object(k.jsx)("div",{children:Object(k.jsxs)(h.m,{className:"ion-text-wrap uiFont",children:[n.issuer," (",n.account,")"]})}),Object(k.jsx)("div",{children:Object(k.jsx)(h.m,{color:"primary",className:"ion-text-wrap uiFontX1_5",children:s},"bookmarkItemLabel_"+r)})]}),Object(k.jsx)(h.m,{className:"ion-text-wrap uiFontX1_5 progressCircle",style:{textAlign:"right"}},"bookmarkItemLabel_"+r),Object(k.jsx)(h.r,{slot:"end"})]},"dictItem"+r),Object(k.jsx)(h.k,{side:"end",children:Object(k.jsx)(h.j,{className:"uiFont",color:"danger",onClick:function(t){var r;e.props.dispatch({type:"DEL_BOOKMARK",uuid:n.uuid}),null===(r=e.bookmarkListRef.current)||void 0===r||r.closeSlidingItems()},children:"\u522a\u9664"})})]},"bookmarkItemSliding_"+r))})),t}},{key:"render",value:function(){var e=this;return Object(k.jsxs)(h.p,{children:[Object(k.jsx)(h.g,{children:Object(k.jsxs)(h.D,{children:[Object(k.jsx)(h.A,{className:"uiFont",children:"\u9a57\u8b49\u78bc"}),Object(k.jsx)(h.c,{fill:this.state.reorder?"solid":"clear",slot:"end",onClick:function(t){return e.setState({reorder:!e.state.reorder})},children:Object(k.jsx)(h.h,{icon:x.u,slot:"icon-only"})})]})}),Object(k.jsxs)(h.d,{children:[0===this.props.settings.bookmarks.length?Object(k.jsx)(h.m,{className:"uiFontX2",children:"\u8acb\u6309\u53f3\u4e0b\u89d2\u52a0\u865f\u9215\uff0c\u6383\u63cf\u96d9\u91cd\u9a57\u8b49 QR code\u3002"}):Object(k.jsx)(h.n,{ref:this.bookmarkListRef,children:Object(k.jsx)(h.s,{disabled:!this.state.reorder,onIonItemReorder:function(t){e.reorderBookmarks(t)},children:this.getRows()})}),Object(k.jsx)(h.e,{vertical:"bottom",horizontal:"end",slot:"fixed",children:Object(k.jsx)(h.f,{onClick:function(t){e.setState({showScanQrCodeModal:!0})},children:Object(k.jsx)(h.h,{icon:x.a})})}),Object(k.jsx)(C,Object(r.a)({},Object(r.a)({showModal:this.state.showScanQrCodeModal,finish:function(t){if(e.setState({showScanQrCodeModal:!1}),null!=t){var n=t.issuer,r=t.account,s=t.secret;e.props.dispatch({type:"ADD_BOOKMARK",bookmark:new g({uuid:Object(j.a)(),issuer:n,account:r,secret:s})}),e.createProgressCircles()}}},this.props))),Object(k.jsx)(h.B,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return e.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})]})}}]),n}(d.a.Component),F=Object(h.O)(T);t.a=Object(f.b)((function(e){return{isLoadingData:e.tmpSettings.isLoadingData,tmpSettings:e.tmpSettings,settings:e.settings}}))(F)},277:function(e,t,n){var r={"./ion-action-sheet.entry.js":[450,5],"./ion-alert.entry.js":[451,6],"./ion-app_8.entry.js":[452,7],"./ion-avatar_3.entry.js":[453,17],"./ion-back-button.entry.js":[454,18],"./ion-backdrop.entry.js":[455,43],"./ion-button_2.entry.js":[456,19],"./ion-card_5.entry.js":[457,20],"./ion-checkbox.entry.js":[458,21],"./ion-chip.entry.js":[459,22],"./ion-col_3.entry.js":[460,44],"./ion-datetime_3.entry.js":[461,10],"./ion-fab_3.entry.js":[462,23],"./ion-img.entry.js":[463,45],"./ion-infinite-scroll_2.entry.js":[464,46],"./ion-input.entry.js":[465,24],"./ion-item-option_3.entry.js":[466,25],"./ion-item_8.entry.js":[467,26],"./ion-loading.entry.js":[468,27],"./ion-menu_3.entry.js":[469,28],"./ion-modal.entry.js":[470,8],"./ion-nav_2.entry.js":[471,14],"./ion-popover.entry.js":[472,9],"./ion-progress-bar.entry.js":[473,29],"./ion-radio_2.entry.js":[474,30],"./ion-range.entry.js":[475,31],"./ion-refresher_2.entry.js":[476,11],"./ion-reorder_2.entry.js":[477,16],"./ion-ripple-effect.entry.js":[478,47],"./ion-route_4.entry.js":[479,32],"./ion-searchbar.entry.js":[480,33],"./ion-segment_2.entry.js":[481,34],"./ion-select_3.entry.js":[482,35],"./ion-slide_2.entry.js":[483,48],"./ion-spinner.entry.js":[484,13],"./ion-split-pane.entry.js":[485,49],"./ion-tab-bar_2.entry.js":[486,36],"./ion-tab_2.entry.js":[487,15],"./ion-text.entry.js":[488,37],"./ion-textarea.entry.js":[489,38],"./ion-toast.entry.js":[490,39],"./ion-toggle.entry.js":[491,12],"./ion-virtual-scroll.entry.js":[492,50]};function s(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],s=t[0];return n.e(t[1]).then((function(){return n(s)}))}s.keys=function(){return Object.keys(r)},s.id=277,e.exports=s},279:function(e,t,n){var r={"./ion-icon.entry.js":[493,57]};function s(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],s=t[0];return n.e(t[1]).then((function(){return n(s)}))}s.keys=function(){return Object.keys(r)},s.id=279,e.exports=s},308:function(e,t,n){},326:function(e,t,n){},331:function(e,t){},333:function(e,t){},343:function(e,t){},345:function(e,t){},370:function(e,t){},372:function(e,t){},373:function(e,t){},378:function(e,t){},380:function(e,t){},386:function(e,t){},388:function(e,t){},407:function(e,t){},419:function(e,t){},422:function(e,t){},427:function(e,t,n){},448:function(e,t,n){"use strict";n.r(t);n(0);var r=n(40),s=n.n(r),o=n(79),a=n(81),i=n(5),c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function l(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){console.log("installingWorker stage changed: ".concat(n.state)),"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var u=n(1);i.a.enableAppLog(),s.a.render(Object(u.jsx)(o.a,{children:Object(u.jsx)(a.a,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/TwoFauth",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/TwoFauth","/service-worker.js");c?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):l(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):l(t,e)}))}}({onSuccess:function(e){console.log("Precache app loaded!"),a.b.onSuccess(e)},onUpdate:function(e){console.log("Found app updated!"),a.b.onUpdate(e)}})},5:function(e,t,n){"use strict";var r=n(4),s=n.n(r),o=n(8),a=n(2),i=n(1),c="/TwoFauth",l="TwoFauthDb",u="";function p(){return(p=Object(o.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=indexedDB.open(l),e.abrupt("return",new Promise((function(e,r){n.onsuccess=function(){var a=Object(o.a)(s.a.mark((function a(i){var c,l,u;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:c=n.result;try{l=c.transaction(["store"],"readwrite"),(u=l.objectStore("store").get(t)).onsuccess=function(){var n=Object(o.a)(s.a.mark((function n(o){var a;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=u.result){n.next=5;break}return console.error("".concat(t," loading failed!")),console.error((new Error).stack),n.abrupt("return",r());case 5:return n.abrupt("return",e(a));case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}catch(i){console.error(i)}case 2:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(){return(d=Object(o.a)(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=indexedDB.open(l),e.abrupt("return",new Promise((function(e,a){r.onsuccess=function(){var i=Object(o.a)(s.a.mark((function o(i){var c,l,u;return s.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:c=r.result,l=c.transaction(["store"],"readwrite"),(u=l.objectStore("store").put(n,t)).onsuccess=function(t){return e()},u.onerror=function(e){return a()};case 5:case"end":return s.stop()}}),o)})));return function(e){return i.apply(this,arguments)}}()})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=Object(o.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=indexedDB.open(l),e.abrupt("return",new Promise((function(e,r){try{n.onsuccess=function(s){var o=n.result.transaction(["store"],"readwrite");try{var a=o.objectStore("store").delete(t);a.onsuccess=function(t){return e()},a.onerror=function(e){return r()}}catch(i){console.error(i)}}}catch(s){r(s)}})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return j.apply(this,arguments)}function j(){return(j=Object(o.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=indexedDB.open(l),e.abrupt("return",new Promise((function(e,n){t.onsuccess=function(){var r=Object(o.a)(s.a.mark((function r(o){var a,i,c;return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=t.result,i=a.transaction(["store"],"readwrite"),(c=i.objectStore("store").clear()).onsuccess=function(t){return e()},c.onerror=function(e){return n()};case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.clear(),e.next=3,f();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){e(t)}),(function(e){t("".concat(e.code,": ").concat(e.message))})):t("No geolocation object!")})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=window.webkit;function g(){var e;return null!=(null===v||void 0===v||null===(e=v.messageHandlers)||void 0===e?void 0:e.swiftCallbackHandler)}var x=!1,w=0;function O(){return(O=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!g()){e.next=4;break}return e.next=4,new Promise(function(){var e=Object(o.a)(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x=!0,v.messageHandlers.swiftCallbackHandler.postMessage({event:"camera"}),r=setInterval((function(){x||(clearInterval(r),w?n():t())}),500);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 4:return e.next=6,navigator.mediaDevices.getUserMedia({video:{width:720,height:1280,facingMode:"environment"}});case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(0),console.error(e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}window.CameraResultCallback=function(e){w=e,x=!1};var y=console.log.bind(console),k=console.error.bind(console);function S(){return Object(a.M)("ios")&&"MacIntel"===navigator.platform}var C={pwaUrl:c,bugReportApiUrl:"https://vh6ud1o56g.execute-api.ap-northeast-1.amazonaws.com/bugReportMailer",storeFile:"TwoFauthSettings.json",getCurrentPosition:function(){return m.apply(this,arguments)},loadCamera:function(){return O.apply(this,arguments)},getLog:function(){return u},enableAppLog:function(){console.log=function(){u+="----- Info ----\n",u+=Array.from(arguments)+"\n",y.apply(console,arguments)},console.error=function(){u+="----- Error ----\n",u+=Array.from(arguments)+"\n",k.apply(console,arguments)}},disableAppLog:function(){u="",console.log=y,console.error=k},TwoFauthDb:l,appSettings:{theme:"\u4f48\u666f\u4e3b\u984c",uiFontSize:"UI \u5b57\u578b\u5927\u5c0f"},fetchErrorContent:Object(i.jsx)("div",{className:"contentCenter",children:Object(i.jsx)(a.m,{children:Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{children:"\u9023\u7dda\u5931\u6557!"}),Object(i.jsxs)("div",{style:{fontSize:"var(--ui-font-size)",paddingTop:24},children:["\u5982\u679c\u554f\u984c\u6301\u7e8c\u767c\u751f\uff0c\u8acb\u57f7\u884c",Object(i.jsx)("a",{href:"/".concat(c,"/settings"),target:"_self",children:"\u8a2d\u5b9a\u9801"}),"\u7684 app \u7570\u5e38\u56de\u5831\u529f\u80fd\u3002"]})]})})}),updateApp:function(){return new Promise(function(){var e=Object(o.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:navigator.serviceWorker.getRegistrations().then(function(){var e=Object(o.a)(s.a.mark((function e(n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return e.update().then((function(e){return null!==e.installing||null!==e.waiting}))})));case 2:r=e.sent,t(r.reduce((function(e,t){return e||t}),!1));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},updateCssVars:function(e){document.documentElement.style.cssText="--ui-font-size: ".concat(e.uiFontSize,"px;")},isMacCatalyst:S,isTouchDevice:function(){return Object(a.M)("ios")&&!S()||Object(a.M)("android")},isStoreApps:function(){return Object(a.M)("pwa")||Object(a.M)("electron")},isWKWebView:g,getFileFromIndexedDB:function(e){return p.apply(this,arguments)},saveFileToIndexedDB:function(e,t){return d.apply(this,arguments)},removeFileFromIndexedDB:function(e){return h.apply(this,arguments)},clearAppData:function(){return b.apply(this,arguments)},removeElementsByClassName:function(e,t){for(var n=e.getElementsByClassName(t);n.length>0;){var r;null===(r=n[0].parentNode)||void 0===r||r.removeChild(n[0])}},disableAndroidChromeCallout:function(e){return e.preventDefault(),e.stopPropagation(),!1},disableIosSafariCallout:function(e){var t=this.getSelection();if(((null===t||void 0===t?void 0:t.rangeCount)||0)>0){var n=null===t||void 0===t?void 0:t.getRangeAt(0);null===t||void 0===t||t.removeAllRanges(),setTimeout((function(){null===t||void 0===t||t.addRange(n)}),50)}},copyToClipboard:function(e){try{navigator.clipboard&&navigator.clipboard.writeText(e)}catch(t){console.error(t)}}};t.a=C},81:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return T}));var r=n(4),s=n.n(r),o=n(8),a=n(29),i=n(7),c=n(10),l=n(12),u=n(13),p=n(0),d=n.n(p),h=n(15),f=n(2),j=n(201),b=n(35),m=n(202),v=n.n(m),g=n(209),x=n(18),w=(n(298),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(203)),O=n(5),y=n(211),k=n(206),S=n(1),C=window.electronBackendApi,A=Object(g.a)();Object(f.N)({mode:"md",swipeBackEnabled:!1});var T={onSuccess:function(e){},onUpdate:function(e){}},F=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(S.jsx)(b.a,{store:A,children:Object(S.jsx)(E,Object(a.a)({},this.props))})}}]),n}(d.a.Component),I=function(t){Object(l.a)(r,t);var n=Object(u.a)(r);function r(t){var a;for(Object(i.a)(this,r),(a=n.call(this,t)).registrationNew=void 0,a.originalAppSettingsStr=void 0,a.wakeLock=void 0,a.props.settings.hasAppLog||O.a.disableAppLog(),null===C||void 0===C||C.receive("fromMain",(function(e){switch(e.event){case"version":A.dispatch({type:"TMP_SET_KEY_VAL",key:"mainVersion",val:e.version})}})),null===C||void 0===C||C.send("toMain",{event:"ready"}),a.registrationNew=null,Object(f.M)("android")?window.oncontextmenu=O.a.disableAndroidChromeCallout:Object(f.M)("ios")&&(document.ontouchend=O.a.disableIosSafariCallout.bind(window));document.body.classList.length>0;)document.body.classList.remove(document.body.classList.item(0));document.body.classList.toggle("theme".concat(a.props.settings.theme),!0);var c=v.a.parse(a.props.location.search);return c.settings&&(a.originalAppSettingsStr=localStorage.getItem(O.a.storeFile),c.settings.split(",").forEach((function(e){var t=e.split("=");a.props.dispatch({type:"SET_KEY_VAL",key:t[0],val:+t[1]})}))),e((function(){O.a.updateCssVars(a.props.settings)})),a.state={showUpdateAlert:!1,showRestoreAppSettingsToast:null!=c.settings&&null!=a.originalAppSettingsStr||!1,showToast:!1,toastMessage:""},T.onUpdate=function(e){a.registrationNew=e,a.setState({showUpdateAlert:!0})},T.onSuccess=function(e){},"undefined"!==typeof speechSynthesis&&(speechSynthesis.getVoices(),speechSynthesis.cancel()),navigator.wakeLock&&(a.wakeLockScreen(),document.addEventListener("visibilitychange",Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"visible"===document.visibilityState?a.wakeLockScreen():a.wakeLockScreenRelease();case 1:case"end":return e.stop()}}),e)}))))),indexedDB.open(O.a.TwoFauthDb).onupgradeneeded=function(e){e.target.result.createObjectStore("store"),console.log("DB store created.")},a}return Object(c.a)(r,[{key:"restoreAppSettings",value:function(){localStorage.setItem(O.a.storeFile,this.originalAppSettingsStr),this.props.dispatch({type:"LOAD_SETTINGS"})}},{key:"wakeLockScreen",value:function(){var e=Object(o.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null==(t=navigator.wakeLock)){e.next=9;break}return e.next=5,t.request("screen");case 5:this.wakeLock=e.sent,console.log("Screen wake lock is requested."),e.next=10;break;case 9:console.error("navigator.wakeLock is undefined.");case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("".concat(e.t0.name,", ").concat(e.t0.message)),console.log((new Error).stack);case 16:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"wakeLockScreenRelease",value:function(){var e=Object(o.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.wakeLock){e.next=5;break}return e.next=3,this.wakeLock.release();case 3:this.wakeLock=null,console.log("Screen wake lock is released.");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"routeByQueryString",value:function(){console.log(window.location.search);var e=/route=([^&]*)/.exec(window.location.search),t=/query=([^&]*)/.exec(window.location.search);if(null!==e){var n=decodeURIComponent(e[1]),r="";return null!==t&&(r=decodeURIComponent(t[1])),Object(S.jsx)(h.a,{to:"".concat(O.a.pwaUrl)+n+r})}if(window.location.pathname==="".concat(O.a.pwaUrl,"/")||window.location.pathname==="".concat(O.a.pwaUrl))return Object(S.jsx)(h.a,{to:"".concat(O.a.pwaUrl,"/list")})}},{key:"render",value:function(){var e,t,n=this;return Object(S.jsxs)(f.b,{children:[Object(S.jsx)(j.a,{children:Object(S.jsxs)(f.z,{children:[Object(S.jsxs)(f.u,{animated:!1,children:[Object(S.jsx)(h.b,{path:"".concat(O.a.pwaUrl,"/list"),render:function(e){return Object(S.jsx)(y.a,Object(a.a)({},e))},exact:!0}),Object(S.jsx)(h.b,{path:"".concat(O.a.pwaUrl,"/settings"),render:function(e){return Object(S.jsx)(w.a,Object(a.a)({},e))}}),Object(S.jsx)(h.b,{path:"".concat(O.a.pwaUrl,"/"),render:function(){return n.routeByQueryString()},exact:!0})]}),Object(S.jsxs)(f.x,{slot:"bottom",children:[Object(S.jsx)(f.y,{tab:"list",href:"".concat(O.a.pwaUrl,"/list"),children:Object(S.jsx)(f.h,{icon:x.m})}),Object(S.jsx)(f.y,{tab:"settings",href:"".concat(O.a.pwaUrl,"/settings"),children:Object(S.jsx)(f.h,{icon:x.t})})]})]})}),Object(S.jsx)(f.a,{cssClass:"uiFont",isOpen:this.state.showUpdateAlert,backdropDismiss:!1,onDidPresent:function(e){var t,r,s,o;null===(t=n.registrationNew)||void 0===t||null===(r=t.installing)||void 0===r||r.postMessage({type:"SKIP_WAITING"}),null===(s=n.registrationNew)||void 0===s||null===(o=s.waiting)||void 0===o||o.postMessage({type:"SKIP_WAITING"})},header:"App \u5df2\u66f4\u65b0\uff0c\u8acb\u91cd\u555f!",buttons:[{text:"\u95dc\u9589",cssClass:"primary uiFont",handler:function(e){n.setState({showUpdateAlert:!1})}}]}),Object(S.jsx)(k.a,Object(a.a)({},Object(a.a)({text:null===(e=this.props.shareTextModal)||void 0===e?void 0:e.text,showModal:(null===(t=this.props.shareTextModal)||void 0===t?void 0:t.show)||!1,finish:function(){A.dispatch({type:"TMP_SET_KEY_VAL",key:"shareTextModal",val:{show:!1}})}},this.props))),Object(S.jsx)(f.B,{cssClass:"uiFont",isOpen:this.state.showRestoreAppSettingsToast,onDidDismiss:function(){return n.setState({showRestoreAppSettingsToast:!1})},message:"\u5df2\u5957\u7528app\u9023\u7d50\u4e2d\u7684\u8a2d\u5b9a\uff0c\u662f\u5426\u9084\u539f\u8a2d\u5b9a\uff1f",buttons:[{text:"\u53d6\u6d88",role:"cancel",handler:function(){return n.setState({showRestoreAppSettingsToast:!1})}},{text:"\u9084\u539f",handler:function(){return n.restoreAppSettings()}}]}),Object(S.jsx)(f.B,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return n.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})}}]),r}(d.a.Component),E=Object(b.b)((function(e){return{shareTextModal:e.tmpSettings.shareTextModal,settings:e.settings,tmpSettings:e.tmpSettings}}))(I),L=Object(h.f)(F);t.a=L}).call(this,n(89).setImmediate)}},[[448,3,4]]]);
//# sourceMappingURL=main.fd42cbbe.chunk.js.map